<!DOCTYPE html>
<HTML lang = "en">
<HEAD>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title>Filament Work-Precision Diagrams</title>
  

  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
      TeX: { equationNumbers: { autoNumber: "AMS" } }
    });
  </script>

  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>

  
<style>
pre.hljl {
    border: 1px solid #ccc;
    margin: 5px;
    padding: 5px;
    overflow-x: auto;
    color: rgb(68,68,68); background-color: rgb(251,251,251); }
pre.hljl > span.hljl-t { }
pre.hljl > span.hljl-w { }
pre.hljl > span.hljl-e { }
pre.hljl > span.hljl-eB { }
pre.hljl > span.hljl-o { }
pre.hljl > span.hljl-k { color: rgb(148,91,176); font-weight: bold; }
pre.hljl > span.hljl-kc { color: rgb(59,151,46); font-style: italic; }
pre.hljl > span.hljl-kd { color: rgb(214,102,97); font-style: italic; }
pre.hljl > span.hljl-kn { color: rgb(148,91,176); font-weight: bold; }
pre.hljl > span.hljl-kp { color: rgb(148,91,176); font-weight: bold; }
pre.hljl > span.hljl-kr { color: rgb(148,91,176); font-weight: bold; }
pre.hljl > span.hljl-kt { color: rgb(148,91,176); font-weight: bold; }
pre.hljl > span.hljl-n { }
pre.hljl > span.hljl-na { }
pre.hljl > span.hljl-nb { }
pre.hljl > span.hljl-nbp { }
pre.hljl > span.hljl-nc { }
pre.hljl > span.hljl-ncB { }
pre.hljl > span.hljl-nd { color: rgb(214,102,97); }
pre.hljl > span.hljl-ne { }
pre.hljl > span.hljl-neB { }
pre.hljl > span.hljl-nf { color: rgb(66,102,213); }
pre.hljl > span.hljl-nfm { color: rgb(66,102,213); }
pre.hljl > span.hljl-np { }
pre.hljl > span.hljl-nl { }
pre.hljl > span.hljl-nn { }
pre.hljl > span.hljl-no { }
pre.hljl > span.hljl-nt { }
pre.hljl > span.hljl-nv { }
pre.hljl > span.hljl-nvc { }
pre.hljl > span.hljl-nvg { }
pre.hljl > span.hljl-nvi { }
pre.hljl > span.hljl-nvm { }
pre.hljl > span.hljl-l { }
pre.hljl > span.hljl-ld { color: rgb(148,91,176); font-style: italic; }
pre.hljl > span.hljl-s { color: rgb(201,61,57); }
pre.hljl > span.hljl-sa { color: rgb(201,61,57); }
pre.hljl > span.hljl-sb { color: rgb(201,61,57); }
pre.hljl > span.hljl-sc { color: rgb(201,61,57); }
pre.hljl > span.hljl-sd { color: rgb(201,61,57); }
pre.hljl > span.hljl-sdB { color: rgb(201,61,57); }
pre.hljl > span.hljl-sdC { color: rgb(201,61,57); }
pre.hljl > span.hljl-se { color: rgb(59,151,46); }
pre.hljl > span.hljl-sh { color: rgb(201,61,57); }
pre.hljl > span.hljl-si { }
pre.hljl > span.hljl-so { color: rgb(201,61,57); }
pre.hljl > span.hljl-sr { color: rgb(201,61,57); }
pre.hljl > span.hljl-ss { color: rgb(201,61,57); }
pre.hljl > span.hljl-ssB { color: rgb(201,61,57); }
pre.hljl > span.hljl-nB { color: rgb(59,151,46); }
pre.hljl > span.hljl-nbB { color: rgb(59,151,46); }
pre.hljl > span.hljl-nfB { color: rgb(59,151,46); }
pre.hljl > span.hljl-nh { color: rgb(59,151,46); }
pre.hljl > span.hljl-ni { color: rgb(59,151,46); }
pre.hljl > span.hljl-nil { color: rgb(59,151,46); }
pre.hljl > span.hljl-noB { color: rgb(59,151,46); }
pre.hljl > span.hljl-oB { color: rgb(102,102,102); font-weight: bold; }
pre.hljl > span.hljl-ow { color: rgb(102,102,102); font-weight: bold; }
pre.hljl > span.hljl-p { }
pre.hljl > span.hljl-c { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-ch { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-cm { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-cp { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-cpB { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-cs { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-csB { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-g { }
pre.hljl > span.hljl-gd { }
pre.hljl > span.hljl-ge { }
pre.hljl > span.hljl-geB { }
pre.hljl > span.hljl-gh { }
pre.hljl > span.hljl-gi { }
pre.hljl > span.hljl-go { }
pre.hljl > span.hljl-gp { }
pre.hljl > span.hljl-gs { }
pre.hljl > span.hljl-gsB { }
pre.hljl > span.hljl-gt { }
</style>



  <style type="text/css">
  @font-face {
  font-style: normal;
  font-weight: 300;
}
@font-face {
  font-style: normal;
  font-weight: 400;
}
@font-face {
  font-style: normal;
  font-weight: 600;
}
html {
  font-family: sans-serif; /* 1 */
  -ms-text-size-adjust: 100%; /* 2 */
  -webkit-text-size-adjust: 100%; /* 2 */
}
body {
  margin: 0;
}
article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
menu,
nav,
section,
summary {
  display: block;
}
audio,
canvas,
progress,
video {
  display: inline-block; /* 1 */
  vertical-align: baseline; /* 2 */
}
audio:not([controls]) {
  display: none;
  height: 0;
}
[hidden],
template {
  display: none;
}
a:active,
a:hover {
  outline: 0;
}
abbr[title] {
  border-bottom: 1px dotted;
}
b,
strong {
  font-weight: bold;
}
dfn {
  font-style: italic;
}
h1 {
  font-size: 2em;
  margin: 0.67em 0;
}
mark {
  background: #ff0;
  color: #000;
}
small {
  font-size: 80%;
}
sub,
sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline;
}
sup {
  top: -0.5em;
}
sub {
  bottom: -0.25em;
}
img {
  border: 0;
}
svg:not(:root) {
  overflow: hidden;
}
figure {
  margin: 1em 40px;
}
hr {
  -moz-box-sizing: content-box;
  box-sizing: content-box;
  height: 0;
}
pre {
  overflow: auto;
}
code,
kbd,
pre,
samp {
  font-family: monospace, monospace;
  font-size: 1em;
}
button,
input,
optgroup,
select,
textarea {
  color: inherit; /* 1 */
  font: inherit; /* 2 */
  margin: 0; /* 3 */
}
button {
  overflow: visible;
}
button,
select {
  text-transform: none;
}
button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
  -webkit-appearance: button; /* 2 */
  cursor: pointer; /* 3 */
}
button[disabled],
html input[disabled] {
  cursor: default;
}
button::-moz-focus-inner,
input::-moz-focus-inner {
  border: 0;
  padding: 0;
}
input {
  line-height: normal;
}
input[type="checkbox"],
input[type="radio"] {
  box-sizing: border-box; /* 1 */
  padding: 0; /* 2 */
}
input[type="number"]::-webkit-inner-spin-button,
input[type="number"]::-webkit-outer-spin-button {
  height: auto;
}
input[type="search"] {
  -webkit-appearance: textfield; /* 1 */
  -moz-box-sizing: content-box;
  -webkit-box-sizing: content-box; /* 2 */
  box-sizing: content-box;
}
input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
  -webkit-appearance: none;
}
fieldset {
  border: 1px solid #c0c0c0;
  margin: 0 2px;
  padding: 0.35em 0.625em 0.75em;
}
legend {
  border: 0; /* 1 */
  padding: 0; /* 2 */
}
textarea {
  overflow: auto;
}
optgroup {
  font-weight: bold;
}
table {
  font-family: monospace, monospace;
  font-size : 0.8em;
  border-collapse: collapse;
  border-spacing: 0;
}
td,
th {
  padding: 0;
}
thead th {
    border-bottom: 1px solid black;
    background-color: white;
}
tr:nth-child(odd){
  background-color: rgb(248,248,248);
}


/*
* Skeleton V2.0.4
* Copyright 2014, Dave Gamache
* www.getskeleton.com
* Free to use under the MIT license.
* http://www.opensource.org/licenses/mit-license.php
* 12/29/2014
*/
.container {
  position: relative;
  width: 100%;
  max-width: 960px;
  margin: 0 auto;
  padding: 0 20px;
  box-sizing: border-box; }
.column,
.columns {
  width: 100%;
  float: left;
  box-sizing: border-box; }
@media (min-width: 400px) {
  .container {
    width: 85%;
    padding: 0; }
}
@media (min-width: 550px) {
  .container {
    width: 80%; }
  .column,
  .columns {
    margin-left: 4%; }
  .column:first-child,
  .columns:first-child {
    margin-left: 0; }

  .one.column,
  .one.columns                    { width: 4.66666666667%; }
  .two.columns                    { width: 13.3333333333%; }
  .three.columns                  { width: 22%;            }
  .four.columns                   { width: 30.6666666667%; }
  .five.columns                   { width: 39.3333333333%; }
  .six.columns                    { width: 48%;            }
  .seven.columns                  { width: 56.6666666667%; }
  .eight.columns                  { width: 65.3333333333%; }
  .nine.columns                   { width: 74.0%;          }
  .ten.columns                    { width: 82.6666666667%; }
  .eleven.columns                 { width: 91.3333333333%; }
  .twelve.columns                 { width: 100%; margin-left: 0; }

  .one-third.column               { width: 30.6666666667%; }
  .two-thirds.column              { width: 65.3333333333%; }

  .one-half.column                { width: 48%; }

  /* Offsets */
  .offset-by-one.column,
  .offset-by-one.columns          { margin-left: 8.66666666667%; }
  .offset-by-two.column,
  .offset-by-two.columns          { margin-left: 17.3333333333%; }
  .offset-by-three.column,
  .offset-by-three.columns        { margin-left: 26%;            }
  .offset-by-four.column,
  .offset-by-four.columns         { margin-left: 34.6666666667%; }
  .offset-by-five.column,
  .offset-by-five.columns         { margin-left: 43.3333333333%; }
  .offset-by-six.column,
  .offset-by-six.columns          { margin-left: 52%;            }
  .offset-by-seven.column,
  .offset-by-seven.columns        { margin-left: 60.6666666667%; }
  .offset-by-eight.column,
  .offset-by-eight.columns        { margin-left: 69.3333333333%; }
  .offset-by-nine.column,
  .offset-by-nine.columns         { margin-left: 78.0%;          }
  .offset-by-ten.column,
  .offset-by-ten.columns          { margin-left: 86.6666666667%; }
  .offset-by-eleven.column,
  .offset-by-eleven.columns       { margin-left: 95.3333333333%; }

  .offset-by-one-third.column,
  .offset-by-one-third.columns    { margin-left: 34.6666666667%; }
  .offset-by-two-thirds.column,
  .offset-by-two-thirds.columns   { margin-left: 69.3333333333%; }

  .offset-by-one-half.column,
  .offset-by-one-half.columns     { margin-left: 52%; }

}
html {
  font-size: 62.5%; }
body {
  font-size: 1.5em; /* currently ems cause chrome bug misinterpreting rems on body element */
  line-height: 1.6;
  font-weight: 400;
  font-family: "Raleway", "HelveticaNeue", "Helvetica Neue", Helvetica, Arial, sans-serif;
  color: #222; }
h1, h2, h3, h4, h5, h6 {
  margin-top: 0;
  margin-bottom: 2rem;
  font-weight: 300; }
h1 { font-size: 3.6rem; line-height: 1.2;  letter-spacing: -.1rem;}
h2 { font-size: 3.4rem; line-height: 1.25; letter-spacing: -.1rem; }
h3 { font-size: 3.2rem; line-height: 1.3;  letter-spacing: -.1rem; }
h4 { font-size: 2.8rem; line-height: 1.35; letter-spacing: -.08rem; }
h5 { font-size: 2.4rem; line-height: 1.5;  letter-spacing: -.05rem; }
h6 { font-size: 1.5rem; line-height: 1.6;  letter-spacing: 0; }

p {
  margin-top: 0; }
a {
  color: #1EAEDB; }
a:hover {
  color: #0FA0CE; }
.button,
button,
input[type="submit"],
input[type="reset"],
input[type="button"] {
  display: inline-block;
  height: 38px;
  padding: 0 30px;
  color: #555;
  text-align: center;
  font-size: 11px;
  font-weight: 600;
  line-height: 38px;
  letter-spacing: .1rem;
  text-transform: uppercase;
  text-decoration: none;
  white-space: nowrap;
  background-color: transparent;
  border-radius: 4px;
  border: 1px solid #bbb;
  cursor: pointer;
  box-sizing: border-box; }
.button:hover,
button:hover,
input[type="submit"]:hover,
input[type="reset"]:hover,
input[type="button"]:hover,
.button:focus,
button:focus,
input[type="submit"]:focus,
input[type="reset"]:focus,
input[type="button"]:focus {
  color: #333;
  border-color: #888;
  outline: 0; }
.button.button-primary,
button.button-primary,
input[type="submit"].button-primary,
input[type="reset"].button-primary,
input[type="button"].button-primary {
  color: #FFF;
  background-color: #33C3F0;
  border-color: #33C3F0; }
.button.button-primary:hover,
button.button-primary:hover,
input[type="submit"].button-primary:hover,
input[type="reset"].button-primary:hover,
input[type="button"].button-primary:hover,
.button.button-primary:focus,
button.button-primary:focus,
input[type="submit"].button-primary:focus,
input[type="reset"].button-primary:focus,
input[type="button"].button-primary:focus {
  color: #FFF;
  background-color: #1EAEDB;
  border-color: #1EAEDB; }
input[type="email"],
input[type="number"],
input[type="search"],
input[type="text"],
input[type="tel"],
input[type="url"],
input[type="password"],
textarea,
select {
  height: 38px;
  padding: 6px 10px; /* The 6px vertically centers text on FF, ignored by Webkit */
  background-color: #fff;
  border: 1px solid #D1D1D1;
  border-radius: 4px;
  box-shadow: none;
  box-sizing: border-box; }
/* Removes awkward default styles on some inputs for iOS */
input[type="email"],
input[type="number"],
input[type="search"],
input[type="text"],
input[type="tel"],
input[type="url"],
input[type="password"],
textarea {
  -webkit-appearance: none;
     -moz-appearance: none;
          appearance: none; }
textarea {
  min-height: 65px;
  padding-top: 6px;
  padding-bottom: 6px; }
input[type="email"]:focus,
input[type="number"]:focus,
input[type="search"]:focus,
input[type="text"]:focus,
input[type="tel"]:focus,
input[type="url"]:focus,
input[type="password"]:focus,
textarea:focus,
select:focus {
  border: 1px solid #33C3F0;
  outline: 0; }
label,
legend {
  display: block;
  margin-bottom: .5rem;
  font-weight: 600; }
fieldset {
  padding: 0;
  border-width: 0; }
input[type="checkbox"],
input[type="radio"] {
  display: inline; }
label > .label-body {
  display: inline-block;
  margin-left: .5rem;
  font-weight: normal; }
ul {
  list-style: circle; }
ol {
  list-style: decimal; }
ul ul,
ul ol,
ol ol,
ol ul {
  margin: 1.5rem 0 1.5rem 3rem;
  font-size: 90%; }
li > p {margin : 0;}
th,
td {
  padding: 12px 15px;
  text-align: left;
  border-bottom: 1px solid #E1E1E1; }
th:first-child,
td:first-child {
  padding-left: 0; }
th:last-child,
td:last-child {
  padding-right: 0; }
button,
.button {
  margin-bottom: 1rem; }
input,
textarea,
select,
fieldset {
  margin-bottom: 1.5rem; }
pre,
blockquote,
dl,
figure,
table,
p,
ul,
ol,
form {
  margin-bottom: 1.0rem; }
.u-full-width {
  width: 100%;
  box-sizing: border-box; }
.u-max-full-width {
  max-width: 100%;
  box-sizing: border-box; }
.u-pull-right {
  float: right; }
.u-pull-left {
  float: left; }
hr {
  margin-top: 3rem;
  margin-bottom: 3.5rem;
  border-width: 0;
  border-top: 1px solid #E1E1E1; }
.container:after,
.row:after,
.u-cf {
  content: "";
  display: table;
  clear: both; }

pre {
  display: block;
  padding: 9.5px;
  margin: 0 0 10px;
  font-size: 13px;
  line-height: 1.42857143;
  word-break: break-all;
  word-wrap: break-word;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre.hljl {
  margin: 0 0 10px;
  display: block;
  background: #f5f5f5;
  border-radius: 4px;
  padding : 5px;
}

pre.output {
  background: #ffffff;
}

pre.code {
  background: #ffffff;
}

pre.julia-error {
  color : red
}

code,
kbd,
pre,
samp {
  font-family: Menlo, Monaco, Consolas, "Courier New", monospace;
  font-size: 13px;
}


@media (min-width: 400px) {}
@media (min-width: 550px) {}
@media (min-width: 750px) {}
@media (min-width: 1000px) {}
@media (min-width: 1200px) {}

h1.title {margin-top : 20px}
img {max-width : 100%}
div.title {text-align: center;}

  </style>



</HEAD>
  <BODY>
    <div class ="container">
      <div class = "row">
        <div class = "col-md-12 twelve columns">

          <div class="title">
            <h1 class="title">Filament Work-Precision Diagrams</h1>
            <h5>\@dextorious, Chris Rackauckas</h5>
            
          </div>

          <h1>Filament Benchmark</h1>
<p>In this notebook we will benchmark a real-world biological model from a paper entitled <a href="https://doi.org/10.1103/PhysRevE.85.041502">Magnetic dipole with a flexible tail as a self-propelling microdevice</a>. This is a system of PDEs representing a Kirchhoff model of an elastic rod, where the equations of motion are given by the Rouse approximation with free boundary conditions.</p>
<h2>Model Implementation</h2>
<p>First we will show the full model implementation. It is not necessary to understand the full model specification in order to understand the benchmark results, but it&#39;s all contained here for completeness. The model is highly optimized, with all internal vectors pre-cached, loops unrolled for efficiency &#40;along with <code>@simd</code> annotations&#41;, a pre-defined Jacobian, matrix multiplications are all in-place, etc. Thus this model is a good stand-in for other optimized PDE solving cases.</p>
<p>The model is thus defined as follows:</p>


<pre class='hljl'>
<span class='hljl-k'>using</span><span class='hljl-t'> </span><span class='hljl-n'>OrdinaryDiffEq</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ODEInterfaceDiffEq</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Sundials</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>DiffEqDevTools</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>LSODA</span><span class='hljl-t'>
</span><span class='hljl-k'>using</span><span class='hljl-t'> </span><span class='hljl-n'>LinearAlgebra</span><span class='hljl-t'>
</span><span class='hljl-k'>using</span><span class='hljl-t'> </span><span class='hljl-n'>Plots</span><span class='hljl-t'>
</span><span class='hljl-nf'>gr</span><span class='hljl-p'>()</span>
</pre>


<pre class="output">
Plots.GRBackend&#40;&#41;
</pre>



<pre class='hljl'>
<span class='hljl-kd'>const</span><span class='hljl-t'> </span><span class='hljl-n'>T</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>Float64</span><span class='hljl-t'>
</span><span class='hljl-k'>abstract type</span><span class='hljl-t'> </span><span class='hljl-n'>AbstractFilamentCache</span><span class='hljl-t'> </span><span class='hljl-k'>end</span><span class='hljl-t'>
</span><span class='hljl-k'>abstract type</span><span class='hljl-t'> </span><span class='hljl-n'>AbstractMagneticForce</span><span class='hljl-t'> </span><span class='hljl-k'>end</span><span class='hljl-t'>
</span><span class='hljl-k'>abstract type</span><span class='hljl-t'> </span><span class='hljl-n'>AbstractInextensibilityCache</span><span class='hljl-t'> </span><span class='hljl-k'>end</span><span class='hljl-t'>
</span><span class='hljl-k'>abstract type</span><span class='hljl-t'> </span><span class='hljl-n'>AbstractSolver</span><span class='hljl-t'> </span><span class='hljl-k'>end</span><span class='hljl-t'>
</span><span class='hljl-k'>abstract type</span><span class='hljl-t'> </span><span class='hljl-n'>AbstractSolverCache</span><span class='hljl-t'> </span><span class='hljl-k'>end</span>
</pre>




<pre class='hljl'>
<span class='hljl-k'>struct</span><span class='hljl-t'> </span><span class='hljl-n'>FerromagneticContinuous</span><span class='hljl-t'> </span><span class='hljl-oB'>&lt;:</span><span class='hljl-t'> </span><span class='hljl-n'>AbstractMagneticForce</span><span class='hljl-t'>
    </span><span class='hljl-n'>ω</span><span class='hljl-t'> </span><span class='hljl-oB'>::</span><span class='hljl-t'> </span><span class='hljl-n'>T</span><span class='hljl-t'>
    </span><span class='hljl-n'>F</span><span class='hljl-t'> </span><span class='hljl-oB'>::</span><span class='hljl-t'> </span><span class='hljl-nf'>Vector</span><span class='hljl-p'>{</span><span class='hljl-n'>T</span><span class='hljl-p'>}</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span><span class='hljl-t'>

</span><span class='hljl-k'>mutable struct</span><span class='hljl-t'> </span><span class='hljl-nf'>FilamentCache</span><span class='hljl-p'>{</span><span class='hljl-t'>
        </span><span class='hljl-n'>MagneticForce</span><span class='hljl-t'>        </span><span class='hljl-oB'>&lt;:</span><span class='hljl-t'> </span><span class='hljl-n'>AbstractMagneticForce</span><span class='hljl-p'>,</span><span class='hljl-t'>
        </span><span class='hljl-n'>InextensibilityCache</span><span class='hljl-t'> </span><span class='hljl-oB'>&lt;:</span><span class='hljl-t'> </span><span class='hljl-n'>AbstractInextensibilityCache</span><span class='hljl-p'>,</span><span class='hljl-t'>
        </span><span class='hljl-n'>SolverCache</span><span class='hljl-t'>          </span><span class='hljl-oB'>&lt;:</span><span class='hljl-t'> </span><span class='hljl-n'>AbstractSolverCache</span><span class='hljl-t'>
            </span><span class='hljl-p'>}</span><span class='hljl-t'> </span><span class='hljl-oB'>&lt;:</span><span class='hljl-t'> </span><span class='hljl-n'>AbstractFilamentCache</span><span class='hljl-t'>
    </span><span class='hljl-n'>N</span><span class='hljl-t'>  </span><span class='hljl-oB'>::</span><span class='hljl-t'> </span><span class='hljl-n'>Int</span><span class='hljl-t'>
    </span><span class='hljl-n'>μ</span><span class='hljl-t'>  </span><span class='hljl-oB'>::</span><span class='hljl-t'> </span><span class='hljl-n'>T</span><span class='hljl-t'>
    </span><span class='hljl-n'>Cm</span><span class='hljl-t'> </span><span class='hljl-oB'>::</span><span class='hljl-t'> </span><span class='hljl-n'>T</span><span class='hljl-t'>
    </span><span class='hljl-n'>x</span><span class='hljl-t'>  </span><span class='hljl-oB'>::</span><span class='hljl-t'> </span><span class='hljl-nf'>SubArray</span><span class='hljl-p'>{</span><span class='hljl-n'>T</span><span class='hljl-p'>,</span><span class='hljl-ni'>1</span><span class='hljl-p'>,</span><span class='hljl-nf'>Vector</span><span class='hljl-p'>{</span><span class='hljl-n'>T</span><span class='hljl-p'>},</span><span class='hljl-nf'>Tuple</span><span class='hljl-p'>{</span><span class='hljl-nf'>StepRange</span><span class='hljl-p'>{</span><span class='hljl-n'>Int</span><span class='hljl-p'>,</span><span class='hljl-n'>Int</span><span class='hljl-p'>}},</span><span class='hljl-kc'>true</span><span class='hljl-p'>}</span><span class='hljl-t'>
    </span><span class='hljl-n'>y</span><span class='hljl-t'>  </span><span class='hljl-oB'>::</span><span class='hljl-t'> </span><span class='hljl-nf'>SubArray</span><span class='hljl-p'>{</span><span class='hljl-n'>T</span><span class='hljl-p'>,</span><span class='hljl-ni'>1</span><span class='hljl-p'>,</span><span class='hljl-nf'>Vector</span><span class='hljl-p'>{</span><span class='hljl-n'>T</span><span class='hljl-p'>},</span><span class='hljl-nf'>Tuple</span><span class='hljl-p'>{</span><span class='hljl-nf'>StepRange</span><span class='hljl-p'>{</span><span class='hljl-n'>Int</span><span class='hljl-p'>,</span><span class='hljl-n'>Int</span><span class='hljl-p'>}},</span><span class='hljl-kc'>true</span><span class='hljl-p'>}</span><span class='hljl-t'>
    </span><span class='hljl-n'>z</span><span class='hljl-t'>  </span><span class='hljl-oB'>::</span><span class='hljl-t'> </span><span class='hljl-nf'>SubArray</span><span class='hljl-p'>{</span><span class='hljl-n'>T</span><span class='hljl-p'>,</span><span class='hljl-ni'>1</span><span class='hljl-p'>,</span><span class='hljl-nf'>Vector</span><span class='hljl-p'>{</span><span class='hljl-n'>T</span><span class='hljl-p'>},</span><span class='hljl-nf'>Tuple</span><span class='hljl-p'>{</span><span class='hljl-nf'>StepRange</span><span class='hljl-p'>{</span><span class='hljl-n'>Int</span><span class='hljl-p'>,</span><span class='hljl-n'>Int</span><span class='hljl-p'>}},</span><span class='hljl-kc'>true</span><span class='hljl-p'>}</span><span class='hljl-t'>
    </span><span class='hljl-n'>A</span><span class='hljl-t'>  </span><span class='hljl-oB'>::</span><span class='hljl-t'> </span><span class='hljl-nf'>Matrix</span><span class='hljl-p'>{</span><span class='hljl-n'>T</span><span class='hljl-p'>}</span><span class='hljl-t'>
    </span><span class='hljl-n'>P</span><span class='hljl-t'>  </span><span class='hljl-oB'>::</span><span class='hljl-t'> </span><span class='hljl-n'>InextensibilityCache</span><span class='hljl-t'>
    </span><span class='hljl-n'>F</span><span class='hljl-t'>  </span><span class='hljl-oB'>::</span><span class='hljl-t'> </span><span class='hljl-n'>MagneticForce</span><span class='hljl-t'>
    </span><span class='hljl-n'>Sc</span><span class='hljl-t'> </span><span class='hljl-oB'>::</span><span class='hljl-t'> </span><span class='hljl-n'>SolverCache</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre>




<pre class='hljl'>
<span class='hljl-k'>struct</span><span class='hljl-t'> </span><span class='hljl-n'>NoHydroProjectionCache</span><span class='hljl-t'> </span><span class='hljl-oB'>&lt;:</span><span class='hljl-t'> </span><span class='hljl-n'>AbstractInextensibilityCache</span><span class='hljl-t'>
    </span><span class='hljl-n'>J</span><span class='hljl-t'>         </span><span class='hljl-oB'>::</span><span class='hljl-t'> </span><span class='hljl-nf'>Matrix</span><span class='hljl-p'>{</span><span class='hljl-n'>T</span><span class='hljl-p'>}</span><span class='hljl-t'>
    </span><span class='hljl-n'>P</span><span class='hljl-t'>         </span><span class='hljl-oB'>::</span><span class='hljl-t'> </span><span class='hljl-nf'>Matrix</span><span class='hljl-p'>{</span><span class='hljl-n'>T</span><span class='hljl-p'>}</span><span class='hljl-t'>
    </span><span class='hljl-n'>J_JT</span><span class='hljl-t'>      </span><span class='hljl-oB'>::</span><span class='hljl-t'> </span><span class='hljl-nf'>Matrix</span><span class='hljl-p'>{</span><span class='hljl-n'>T</span><span class='hljl-p'>}</span><span class='hljl-t'>
    </span><span class='hljl-n'>J_JT_LDLT</span><span class='hljl-t'> </span><span class='hljl-oB'>::</span><span class='hljl-t'> </span><span class='hljl-n'>LinearAlgebra</span><span class='hljl-oB'>.</span><span class='hljl-nf'>LDLt</span><span class='hljl-p'>{</span><span class='hljl-n'>T</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nf'>SymTridiagonal</span><span class='hljl-p'>{</span><span class='hljl-n'>T</span><span class='hljl-p'>}}</span><span class='hljl-t'>
    </span><span class='hljl-n'>P0</span><span class='hljl-t'>        </span><span class='hljl-oB'>::</span><span class='hljl-t'> </span><span class='hljl-nf'>Matrix</span><span class='hljl-p'>{</span><span class='hljl-n'>T</span><span class='hljl-p'>}</span><span class='hljl-t'>

    </span><span class='hljl-nf'>NoHydroProjectionCache</span><span class='hljl-p'>(</span><span class='hljl-n'>N</span><span class='hljl-oB'>::</span><span class='hljl-n'>Int</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>new</span><span class='hljl-p'>(</span><span class='hljl-t'>
        </span><span class='hljl-nf'>zeros</span><span class='hljl-p'>(</span><span class='hljl-n'>N</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>N</span><span class='hljl-oB'>+</span><span class='hljl-ni'>1</span><span class='hljl-p'>)),</span><span class='hljl-t'>          </span><span class='hljl-cs'># J</span><span class='hljl-t'>
        </span><span class='hljl-nf'>zeros</span><span class='hljl-p'>(</span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>N</span><span class='hljl-oB'>+</span><span class='hljl-ni'>1</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>N</span><span class='hljl-oB'>+</span><span class='hljl-ni'>1</span><span class='hljl-p'>)),</span><span class='hljl-t'>    </span><span class='hljl-cs'># P</span><span class='hljl-t'>
        </span><span class='hljl-nf'>zeros</span><span class='hljl-p'>(</span><span class='hljl-n'>N</span><span class='hljl-p'>,</span><span class='hljl-n'>N</span><span class='hljl-p'>),</span><span class='hljl-t'>                 </span><span class='hljl-cs'># J_JT</span><span class='hljl-t'>
        </span><span class='hljl-n'>LinearAlgebra</span><span class='hljl-oB'>.</span><span class='hljl-nf'>LDLt</span><span class='hljl-p'>{</span><span class='hljl-n'>T</span><span class='hljl-p'>,</span><span class='hljl-nf'>SymTridiagonal</span><span class='hljl-p'>{</span><span class='hljl-n'>T</span><span class='hljl-p'>}}(</span><span class='hljl-nf'>SymTridiagonal</span><span class='hljl-p'>(</span><span class='hljl-nf'>zeros</span><span class='hljl-p'>(</span><span class='hljl-n'>N</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-nf'>zeros</span><span class='hljl-p'>(</span><span class='hljl-n'>N</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-p'>))),</span><span class='hljl-t'>
        </span><span class='hljl-nf'>zeros</span><span class='hljl-p'>(</span><span class='hljl-n'>N</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>N</span><span class='hljl-oB'>+</span><span class='hljl-ni'>1</span><span class='hljl-p'>))</span><span class='hljl-t'>
    </span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre>




<pre class='hljl'>
<span class='hljl-k'>struct</span><span class='hljl-t'> </span><span class='hljl-n'>DiffEqSolverCache</span><span class='hljl-t'> </span><span class='hljl-oB'>&lt;:</span><span class='hljl-t'> </span><span class='hljl-n'>AbstractSolverCache</span><span class='hljl-t'>
    </span><span class='hljl-n'>S1</span><span class='hljl-t'> </span><span class='hljl-oB'>::</span><span class='hljl-t'> </span><span class='hljl-nf'>Vector</span><span class='hljl-p'>{</span><span class='hljl-n'>T</span><span class='hljl-p'>}</span><span class='hljl-t'>
    </span><span class='hljl-n'>S2</span><span class='hljl-t'> </span><span class='hljl-oB'>::</span><span class='hljl-t'> </span><span class='hljl-nf'>Vector</span><span class='hljl-p'>{</span><span class='hljl-n'>T</span><span class='hljl-p'>}</span><span class='hljl-t'>

    </span><span class='hljl-nf'>DiffEqSolverCache</span><span class='hljl-p'>(</span><span class='hljl-n'>N</span><span class='hljl-oB'>::</span><span class='hljl-n'>Integer</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>new</span><span class='hljl-p'>(</span><span class='hljl-nf'>zeros</span><span class='hljl-p'>(</span><span class='hljl-n'>T</span><span class='hljl-p'>,</span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>N</span><span class='hljl-oB'>+</span><span class='hljl-ni'>1</span><span class='hljl-p'>)),</span><span class='hljl-t'> </span><span class='hljl-nf'>zeros</span><span class='hljl-p'>(</span><span class='hljl-n'>T</span><span class='hljl-p'>,</span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>N</span><span class='hljl-oB'>+</span><span class='hljl-ni'>1</span><span class='hljl-p'>)))</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre>




<pre class='hljl'>
<span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>FilamentCache</span><span class='hljl-p'>(</span><span class='hljl-n'>N</span><span class='hljl-oB'>=</span><span class='hljl-ni'>20</span><span class='hljl-p'>;</span><span class='hljl-t'> </span><span class='hljl-n'>Cm</span><span class='hljl-oB'>=</span><span class='hljl-ni'>32</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ω</span><span class='hljl-oB'>=</span><span class='hljl-ni'>200</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Solver</span><span class='hljl-oB'>=</span><span class='hljl-n'>SolverDiffEq</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>InextensibilityCache</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>NoHydroProjectionCache</span><span class='hljl-t'>
    </span><span class='hljl-n'>SolverCache</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>DiffEqSolverCache</span><span class='hljl-t'>
    </span><span class='hljl-n'>tmp</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>zeros</span><span class='hljl-p'>(</span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>N</span><span class='hljl-oB'>+</span><span class='hljl-ni'>1</span><span class='hljl-p'>))</span><span class='hljl-t'>
    </span><span class='hljl-nf'>FilamentCache</span><span class='hljl-p'>{</span><span class='hljl-n'>FerromagneticContinuous</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>InextensibilityCache</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>SolverCache</span><span class='hljl-p'>}(</span><span class='hljl-t'>
        </span><span class='hljl-n'>N</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>N</span><span class='hljl-oB'>+</span><span class='hljl-ni'>1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Cm</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nf'>view</span><span class='hljl-p'>(</span><span class='hljl-n'>tmp</span><span class='hljl-p'>,</span><span class='hljl-ni'>1</span><span class='hljl-oB'>:</span><span class='hljl-ni'>3</span><span class='hljl-oB'>:</span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>N</span><span class='hljl-oB'>+</span><span class='hljl-ni'>1</span><span class='hljl-p'>)),</span><span class='hljl-t'> </span><span class='hljl-nf'>view</span><span class='hljl-p'>(</span><span class='hljl-n'>tmp</span><span class='hljl-p'>,</span><span class='hljl-ni'>2</span><span class='hljl-oB'>:</span><span class='hljl-ni'>3</span><span class='hljl-oB'>:</span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>N</span><span class='hljl-oB'>+</span><span class='hljl-ni'>1</span><span class='hljl-p'>)),</span><span class='hljl-t'> </span><span class='hljl-nf'>view</span><span class='hljl-p'>(</span><span class='hljl-n'>tmp</span><span class='hljl-p'>,</span><span class='hljl-ni'>3</span><span class='hljl-oB'>:</span><span class='hljl-ni'>3</span><span class='hljl-oB'>:</span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>N</span><span class='hljl-oB'>+</span><span class='hljl-ni'>1</span><span class='hljl-p'>)),</span><span class='hljl-t'>
        </span><span class='hljl-nf'>zeros</span><span class='hljl-p'>(</span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>N</span><span class='hljl-oB'>+</span><span class='hljl-ni'>1</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>N</span><span class='hljl-oB'>+</span><span class='hljl-ni'>1</span><span class='hljl-p'>)),</span><span class='hljl-t'> </span><span class='hljl-cs'># A</span><span class='hljl-t'>
        </span><span class='hljl-nf'>InextensibilityCache</span><span class='hljl-p'>(</span><span class='hljl-n'>N</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-cs'># P</span><span class='hljl-t'>
        </span><span class='hljl-nf'>FerromagneticContinuous</span><span class='hljl-p'>(</span><span class='hljl-n'>ω</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nf'>zeros</span><span class='hljl-p'>(</span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>N</span><span class='hljl-oB'>+</span><span class='hljl-ni'>1</span><span class='hljl-p'>))),</span><span class='hljl-t'>
        </span><span class='hljl-nf'>SolverCache</span><span class='hljl-p'>(</span><span class='hljl-n'>N</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre>


<pre class="output">
Main.WeaveSandBox4.FilamentCache
</pre>



<pre class='hljl'>
<span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>stiffness_matrix!</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-oB'>::</span><span class='hljl-n'>AbstractFilamentCache</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>N</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>μ</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>A</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-n'>N</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-n'>μ</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-n'>A</span><span class='hljl-t'>
    </span><span class='hljl-nd'>@inbounds</span><span class='hljl-t'> </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-n'>j</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-nf'>axes</span><span class='hljl-p'>(</span><span class='hljl-n'>A</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>i</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-nf'>axes</span><span class='hljl-p'>(</span><span class='hljl-n'>A</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-t'>
      </span><span class='hljl-n'>A</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>j</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>j</span><span class='hljl-t'> </span><span class='hljl-oB'>==</span><span class='hljl-t'> </span><span class='hljl-n'>i</span><span class='hljl-t'> </span><span class='hljl-oB'>?</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>:</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-t'>
    </span><span class='hljl-k'>end</span><span class='hljl-t'>
    </span><span class='hljl-nd'>@inbounds</span><span class='hljl-t'> </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-n'>i</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>:</span><span class='hljl-t'> </span><span class='hljl-ni'>3</span><span class='hljl-t'>
        </span><span class='hljl-n'>A</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>,</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'>    </span><span class='hljl-ni'>1</span><span class='hljl-t'>
        </span><span class='hljl-n'>A</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>,</span><span class='hljl-ni'>3</span><span class='hljl-oB'>+</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-ni'>2</span><span class='hljl-t'>
        </span><span class='hljl-n'>A</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>,</span><span class='hljl-ni'>6</span><span class='hljl-oB'>+</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'>  </span><span class='hljl-ni'>1</span><span class='hljl-t'>

        </span><span class='hljl-n'>A</span><span class='hljl-p'>[</span><span class='hljl-ni'>3</span><span class='hljl-oB'>+</span><span class='hljl-n'>i</span><span class='hljl-p'>,</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'>   </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-ni'>2</span><span class='hljl-t'>
        </span><span class='hljl-n'>A</span><span class='hljl-p'>[</span><span class='hljl-ni'>3</span><span class='hljl-oB'>+</span><span class='hljl-n'>i</span><span class='hljl-p'>,</span><span class='hljl-ni'>3</span><span class='hljl-oB'>+</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'>  </span><span class='hljl-ni'>5</span><span class='hljl-t'>
        </span><span class='hljl-n'>A</span><span class='hljl-p'>[</span><span class='hljl-ni'>3</span><span class='hljl-oB'>+</span><span class='hljl-n'>i</span><span class='hljl-p'>,</span><span class='hljl-ni'>6</span><span class='hljl-oB'>+</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-ni'>4</span><span class='hljl-t'>
        </span><span class='hljl-n'>A</span><span class='hljl-p'>[</span><span class='hljl-ni'>3</span><span class='hljl-oB'>+</span><span class='hljl-n'>i</span><span class='hljl-p'>,</span><span class='hljl-ni'>9</span><span class='hljl-oB'>+</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'>  </span><span class='hljl-ni'>1</span><span class='hljl-t'>

        </span><span class='hljl-n'>A</span><span class='hljl-p'>[</span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>N</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-oB'>+</span><span class='hljl-n'>i</span><span class='hljl-p'>,</span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>N</span><span class='hljl-oB'>-</span><span class='hljl-ni'>3</span><span class='hljl-p'>)</span><span class='hljl-oB'>+</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'>  </span><span class='hljl-ni'>1</span><span class='hljl-t'>
        </span><span class='hljl-n'>A</span><span class='hljl-p'>[</span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>N</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-oB'>+</span><span class='hljl-n'>i</span><span class='hljl-p'>,</span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>N</span><span class='hljl-oB'>-</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-oB'>+</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-ni'>4</span><span class='hljl-t'>
        </span><span class='hljl-n'>A</span><span class='hljl-p'>[</span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>N</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-oB'>+</span><span class='hljl-n'>i</span><span class='hljl-p'>,</span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>N</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-oB'>+</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'>  </span><span class='hljl-ni'>5</span><span class='hljl-t'>
        </span><span class='hljl-n'>A</span><span class='hljl-p'>[</span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>N</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-oB'>+</span><span class='hljl-n'>i</span><span class='hljl-p'>,</span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-n'>N</span><span class='hljl-oB'>+</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'>     </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-ni'>2</span><span class='hljl-t'>

        </span><span class='hljl-n'>A</span><span class='hljl-p'>[</span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-n'>N</span><span class='hljl-oB'>+</span><span class='hljl-n'>i</span><span class='hljl-p'>,</span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>N</span><span class='hljl-oB'>-</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-oB'>+</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'>     </span><span class='hljl-oB'>=</span><span class='hljl-t'>  </span><span class='hljl-ni'>1</span><span class='hljl-t'>
        </span><span class='hljl-n'>A</span><span class='hljl-p'>[</span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-n'>N</span><span class='hljl-oB'>+</span><span class='hljl-n'>i</span><span class='hljl-p'>,</span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>N</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-oB'>+</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'>     </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-ni'>2</span><span class='hljl-t'>
        </span><span class='hljl-n'>A</span><span class='hljl-p'>[</span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-n'>N</span><span class='hljl-oB'>+</span><span class='hljl-n'>i</span><span class='hljl-p'>,</span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-n'>N</span><span class='hljl-oB'>+</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'>         </span><span class='hljl-oB'>=</span><span class='hljl-t'>  </span><span class='hljl-ni'>1</span><span class='hljl-t'>

        </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-n'>j</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-t'> </span><span class='hljl-oB'>:</span><span class='hljl-t'> </span><span class='hljl-n'>N</span><span class='hljl-oB'>-</span><span class='hljl-ni'>2</span><span class='hljl-t'>
            </span><span class='hljl-n'>A</span><span class='hljl-p'>[</span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-n'>j</span><span class='hljl-oB'>+</span><span class='hljl-n'>i</span><span class='hljl-p'>,</span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-n'>j</span><span class='hljl-oB'>+</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'>     </span><span class='hljl-oB'>=</span><span class='hljl-t'>  </span><span class='hljl-ni'>6</span><span class='hljl-t'>
            </span><span class='hljl-n'>A</span><span class='hljl-p'>[</span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-n'>j</span><span class='hljl-oB'>+</span><span class='hljl-n'>i</span><span class='hljl-p'>,</span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>j</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-oB'>+</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-ni'>4</span><span class='hljl-t'>
            </span><span class='hljl-n'>A</span><span class='hljl-p'>[</span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-n'>j</span><span class='hljl-oB'>+</span><span class='hljl-n'>i</span><span class='hljl-p'>,</span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>j</span><span class='hljl-oB'>+</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-oB'>+</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-ni'>4</span><span class='hljl-t'>
            </span><span class='hljl-n'>A</span><span class='hljl-p'>[</span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-n'>j</span><span class='hljl-oB'>+</span><span class='hljl-n'>i</span><span class='hljl-p'>,</span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>j</span><span class='hljl-oB'>-</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-oB'>+</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'>  </span><span class='hljl-ni'>1</span><span class='hljl-t'>
            </span><span class='hljl-n'>A</span><span class='hljl-p'>[</span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-n'>j</span><span class='hljl-oB'>+</span><span class='hljl-n'>i</span><span class='hljl-p'>,</span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>j</span><span class='hljl-oB'>+</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-oB'>+</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'>  </span><span class='hljl-ni'>1</span><span class='hljl-t'>
        </span><span class='hljl-k'>end</span><span class='hljl-t'>
    </span><span class='hljl-k'>end</span><span class='hljl-t'>
    </span><span class='hljl-nf'>rmul!</span><span class='hljl-p'>(</span><span class='hljl-n'>A</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-n'>μ</span><span class='hljl-oB'>^</span><span class='hljl-ni'>4</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>nothing</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre>


<pre class="output">
stiffness_matrix&#33; &#40;generic function with 1 method&#41;
</pre>



<pre class='hljl'>
<span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>update_separate_coordinates!</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-oB'>::</span><span class='hljl-n'>AbstractFilamentCache</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>r</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>N</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>y</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>z</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-n'>N</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-n'>y</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-n'>z</span><span class='hljl-t'>
    </span><span class='hljl-nd'>@inbounds</span><span class='hljl-t'> </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-n'>i</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>:</span><span class='hljl-t'> </span><span class='hljl-nf'>length</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'>
        </span><span class='hljl-n'>x</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>r</span><span class='hljl-p'>[</span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-n'>i</span><span class='hljl-oB'>-</span><span class='hljl-ni'>2</span><span class='hljl-p'>]</span><span class='hljl-t'>
        </span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>r</span><span class='hljl-p'>[</span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-n'>i</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-t'>
        </span><span class='hljl-n'>z</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>r</span><span class='hljl-p'>[</span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'>
    </span><span class='hljl-k'>end</span><span class='hljl-t'>
    </span><span class='hljl-n'>nothing</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span><span class='hljl-t'>

</span><span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>update_united_coordinates!</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-oB'>::</span><span class='hljl-n'>AbstractFilamentCache</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>r</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>N</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>y</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>z</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-n'>N</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-n'>y</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-n'>z</span><span class='hljl-t'>
    </span><span class='hljl-nd'>@inbounds</span><span class='hljl-t'> </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-n'>i</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>:</span><span class='hljl-t'> </span><span class='hljl-nf'>length</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'>
        </span><span class='hljl-n'>r</span><span class='hljl-p'>[</span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-n'>i</span><span class='hljl-oB'>-</span><span class='hljl-ni'>2</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'>
        </span><span class='hljl-n'>r</span><span class='hljl-p'>[</span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-n'>i</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'>
        </span><span class='hljl-n'>r</span><span class='hljl-p'>[</span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'>   </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>z</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'>
    </span><span class='hljl-k'>end</span><span class='hljl-t'>
    </span><span class='hljl-n'>nothing</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span><span class='hljl-t'>

</span><span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>update_united_coordinates</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-oB'>::</span><span class='hljl-n'>AbstractFilamentCache</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>r</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>zeros</span><span class='hljl-p'>(</span><span class='hljl-n'>T</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-nf'>length</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-n'>x</span><span class='hljl-p'>))</span><span class='hljl-t'>
    </span><span class='hljl-nf'>update_united_coordinates!</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>r</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>r</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre>


<pre class="output">
update_united_coordinates &#40;generic function with 1 method&#41;
</pre>



<pre class='hljl'>
<span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>initialize!</span><span class='hljl-p'>(</span><span class='hljl-n'>initial_conf_type</span><span class='hljl-oB'>::</span><span class='hljl-n'>Symbol</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>::</span><span class='hljl-n'>AbstractFilamentCache</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>N</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>y</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>z</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-n'>N</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-n'>y</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-n'>z</span><span class='hljl-t'>
    </span><span class='hljl-k'>if</span><span class='hljl-t'> </span><span class='hljl-n'>initial_conf_type</span><span class='hljl-t'> </span><span class='hljl-oB'>==</span><span class='hljl-t'> </span><span class='hljl-sc'>:StraightX</span><span class='hljl-t'>
        </span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>.=</span><span class='hljl-t'> </span><span class='hljl-nf'>range</span><span class='hljl-p'>(</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>stop</span><span class='hljl-oB'>=</span><span class='hljl-ni'>1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>length</span><span class='hljl-oB'>=</span><span class='hljl-n'>N</span><span class='hljl-oB'>+</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-t'>
        </span><span class='hljl-n'>y</span><span class='hljl-t'> </span><span class='hljl-oB'>.=</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-t'>
        </span><span class='hljl-n'>z</span><span class='hljl-t'> </span><span class='hljl-oB'>.=</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-t'>
    </span><span class='hljl-k'>else</span><span class='hljl-t'>
        </span><span class='hljl-nf'>error</span><span class='hljl-p'>(</span><span class='hljl-s'>&quot;Unknown initial configuration requested.&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-k'>end</span><span class='hljl-t'>
    </span><span class='hljl-nf'>update_united_coordinates</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre>


<pre class="output">
initialize&#33; &#40;generic function with 1 method&#41;
</pre>



<pre class='hljl'>
<span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>magnetic_force!</span><span class='hljl-p'>(</span><span class='hljl-oB'>::</span><span class='hljl-n'>FerromagneticContinuous</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>::</span><span class='hljl-n'>AbstractFilamentCache</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>t</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-cs'># TODO: generalize this for different magnetic fields as well</span><span class='hljl-t'>
    </span><span class='hljl-n'>N</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>μ</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Cm</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ω</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-n'>N</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-n'>μ</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-n'>Cm</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-n'>F</span><span class='hljl-oB'>.</span><span class='hljl-n'>ω</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-n'>F</span><span class='hljl-oB'>.</span><span class='hljl-n'>F</span><span class='hljl-t'>
    </span><span class='hljl-n'>F</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-t'>         </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-n'>μ</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>Cm</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-nf'>cos</span><span class='hljl-p'>(</span><span class='hljl-n'>ω</span><span class='hljl-oB'>*</span><span class='hljl-n'>t</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>F</span><span class='hljl-p'>[</span><span class='hljl-ni'>2</span><span class='hljl-p'>]</span><span class='hljl-t'>         </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-n'>μ</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>Cm</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-nf'>sin</span><span class='hljl-p'>(</span><span class='hljl-n'>ω</span><span class='hljl-oB'>*</span><span class='hljl-n'>t</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>F</span><span class='hljl-p'>[</span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>N</span><span class='hljl-oB'>+</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-oB'>-</span><span class='hljl-ni'>2</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'>  </span><span class='hljl-n'>μ</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>Cm</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-nf'>cos</span><span class='hljl-p'>(</span><span class='hljl-n'>ω</span><span class='hljl-oB'>*</span><span class='hljl-n'>t</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>F</span><span class='hljl-p'>[</span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>N</span><span class='hljl-oB'>+</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'>  </span><span class='hljl-n'>μ</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>Cm</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-nf'>sin</span><span class='hljl-p'>(</span><span class='hljl-n'>ω</span><span class='hljl-oB'>*</span><span class='hljl-n'>t</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>nothing</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre>


<pre class="output">
magnetic_force&#33; &#40;generic function with 1 method&#41;
</pre>



<pre class='hljl'>
<span class='hljl-k'>struct</span><span class='hljl-t'> </span><span class='hljl-n'>SolverDiffEq</span><span class='hljl-t'> </span><span class='hljl-oB'>&lt;:</span><span class='hljl-t'> </span><span class='hljl-n'>AbstractSolver</span><span class='hljl-t'> </span><span class='hljl-k'>end</span><span class='hljl-t'>

</span><span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-oB'>::</span><span class='hljl-n'>FilamentCache</span><span class='hljl-p'>)(</span><span class='hljl-n'>dr</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>r</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>p</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>t</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-nd'>@views</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-n'>y</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-n'>z</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>r</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-oB'>:</span><span class='hljl-ni'>3</span><span class='hljl-oB'>:</span><span class='hljl-k'>end</span><span class='hljl-p'>],</span><span class='hljl-t'> </span><span class='hljl-n'>r</span><span class='hljl-p'>[</span><span class='hljl-ni'>2</span><span class='hljl-oB'>:</span><span class='hljl-ni'>3</span><span class='hljl-oB'>:</span><span class='hljl-k'>end</span><span class='hljl-p'>],</span><span class='hljl-t'> </span><span class='hljl-n'>r</span><span class='hljl-p'>[</span><span class='hljl-ni'>3</span><span class='hljl-oB'>:</span><span class='hljl-ni'>3</span><span class='hljl-oB'>:</span><span class='hljl-k'>end</span><span class='hljl-p'>]</span><span class='hljl-t'>
    </span><span class='hljl-nf'>jacobian!</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-nf'>projection!</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-nf'>magnetic_force!</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-n'>F</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>t</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>A</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>P</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>F</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>S1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>S2</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-n'>A</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-n'>P</span><span class='hljl-oB'>.</span><span class='hljl-n'>P</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-n'>F</span><span class='hljl-oB'>.</span><span class='hljl-n'>F</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-n'>Sc</span><span class='hljl-oB'>.</span><span class='hljl-n'>S1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-n'>Sc</span><span class='hljl-oB'>.</span><span class='hljl-n'>S2</span><span class='hljl-t'>

    </span><span class='hljl-cs'># implement dr = P * (A*r + F) in an optimized way to avoid temporaries</span><span class='hljl-t'>
    </span><span class='hljl-nf'>mul!</span><span class='hljl-p'>(</span><span class='hljl-n'>S1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>A</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>r</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>S1</span><span class='hljl-t'> </span><span class='hljl-oB'>.+=</span><span class='hljl-t'> </span><span class='hljl-n'>F</span><span class='hljl-t'>
    </span><span class='hljl-nf'>mul!</span><span class='hljl-p'>(</span><span class='hljl-n'>S2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>P</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>S1</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-nf'>copy!</span><span class='hljl-p'>(</span><span class='hljl-n'>dr</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>S2</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-k'>return</span><span class='hljl-t'> </span><span class='hljl-n'>dr</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre>




<pre class='hljl'>
<span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>jacobian!</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-oB'>::</span><span class='hljl-n'>FilamentCache</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>N</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>y</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>z</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>J</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-n'>N</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-n'>y</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-n'>z</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-n'>P</span><span class='hljl-oB'>.</span><span class='hljl-n'>J</span><span class='hljl-t'>
    </span><span class='hljl-nd'>@inbounds</span><span class='hljl-t'> </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-n'>i</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>:</span><span class='hljl-t'> </span><span class='hljl-n'>N</span><span class='hljl-t'>
        </span><span class='hljl-n'>J</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-n'>i</span><span class='hljl-oB'>-</span><span class='hljl-ni'>2</span><span class='hljl-p'>]</span><span class='hljl-t'>     </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-ni'>2</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-oB'>+</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-oB'>-</span><span class='hljl-n'>x</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>])</span><span class='hljl-t'>
        </span><span class='hljl-n'>J</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-n'>i</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-t'>     </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-ni'>2</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-oB'>+</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-oB'>-</span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>])</span><span class='hljl-t'>
        </span><span class='hljl-n'>J</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'>       </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-ni'>2</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>z</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-oB'>+</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-oB'>-</span><span class='hljl-n'>z</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>])</span><span class='hljl-t'>
        </span><span class='hljl-n'>J</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>i</span><span class='hljl-oB'>+</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-oB'>-</span><span class='hljl-ni'>2</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'>  </span><span class='hljl-ni'>2</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-oB'>+</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-oB'>-</span><span class='hljl-n'>x</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>])</span><span class='hljl-t'>
        </span><span class='hljl-n'>J</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>i</span><span class='hljl-oB'>+</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'>  </span><span class='hljl-ni'>2</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-oB'>+</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-oB'>-</span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>])</span><span class='hljl-t'>
        </span><span class='hljl-n'>J</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>i</span><span class='hljl-oB'>+</span><span class='hljl-ni'>1</span><span class='hljl-p'>)]</span><span class='hljl-t'>   </span><span class='hljl-oB'>=</span><span class='hljl-t'>  </span><span class='hljl-ni'>2</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>z</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-oB'>+</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-oB'>-</span><span class='hljl-n'>z</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>])</span><span class='hljl-t'>
    </span><span class='hljl-k'>end</span><span class='hljl-t'>
    </span><span class='hljl-n'>nothing</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre>


<pre class="output">
jacobian&#33; &#40;generic function with 1 method&#41;
</pre>



<pre class='hljl'>
<span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>projection!</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-oB'>::</span><span class='hljl-n'>FilamentCache</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-cs'># implement P[:] = I - J&#39;/(J*J&#39;)*J in an optimized way to avoid temporaries</span><span class='hljl-t'>
    </span><span class='hljl-n'>J</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>P</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>J_JT</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>J_JT_LDLT</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>P0</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-n'>P</span><span class='hljl-oB'>.</span><span class='hljl-n'>J</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-n'>P</span><span class='hljl-oB'>.</span><span class='hljl-n'>P</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-n'>P</span><span class='hljl-oB'>.</span><span class='hljl-n'>J_JT</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-n'>P</span><span class='hljl-oB'>.</span><span class='hljl-n'>J_JT_LDLT</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-n'>P</span><span class='hljl-oB'>.</span><span class='hljl-n'>P0</span><span class='hljl-t'>
    </span><span class='hljl-nf'>mul!</span><span class='hljl-p'>(</span><span class='hljl-n'>J_JT</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>J</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>J</span><span class='hljl-oB'>&#39;</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-nf'>LDLt_inplace!</span><span class='hljl-p'>(</span><span class='hljl-n'>J_JT_LDLT</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>J_JT</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-nf'>ldiv!</span><span class='hljl-p'>(</span><span class='hljl-n'>P0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>J_JT_LDLT</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>J</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-nf'>mul!</span><span class='hljl-p'>(</span><span class='hljl-n'>P</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>P0</span><span class='hljl-oB'>&#39;</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>J</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-nf'>subtract_from_identity!</span><span class='hljl-p'>(</span><span class='hljl-n'>P</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>nothing</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre>


<pre class="output">
projection&#33; &#40;generic function with 1 method&#41;
</pre>



<pre class='hljl'>
<span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>subtract_from_identity!</span><span class='hljl-p'>(</span><span class='hljl-n'>A</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-nf'>lmul!</span><span class='hljl-p'>(</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>A</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-nd'>@inbounds</span><span class='hljl-t'> </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-n'>i</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>:</span><span class='hljl-t'> </span><span class='hljl-nf'>size</span><span class='hljl-p'>(</span><span class='hljl-n'>A</span><span class='hljl-p'>,</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-t'>
        </span><span class='hljl-n'>A</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>,</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>+=</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'>
    </span><span class='hljl-k'>end</span><span class='hljl-t'>
    </span><span class='hljl-n'>nothing</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre>


<pre class="output">
subtract_from_identity&#33; &#40;generic function with 1 method&#41;
</pre>



<pre class='hljl'>
<span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>LDLt_inplace!</span><span class='hljl-p'>(</span><span class='hljl-n'>L</span><span class='hljl-oB'>::</span><span class='hljl-n'>LinearAlgebra</span><span class='hljl-oB'>.</span><span class='hljl-nf'>LDLt</span><span class='hljl-p'>{</span><span class='hljl-n'>T</span><span class='hljl-p'>,</span><span class='hljl-nf'>SymTridiagonal</span><span class='hljl-p'>{</span><span class='hljl-n'>T</span><span class='hljl-p'>}},</span><span class='hljl-t'> </span><span class='hljl-n'>A</span><span class='hljl-oB'>::</span><span class='hljl-nf'>Matrix</span><span class='hljl-p'>{</span><span class='hljl-n'>T</span><span class='hljl-p'>})</span><span class='hljl-t'> </span><span class='hljl-n'>where</span><span class='hljl-t'> </span><span class='hljl-p'>{</span><span class='hljl-n'>T</span><span class='hljl-oB'>&lt;:</span><span class='hljl-n'>Real</span><span class='hljl-p'>}</span><span class='hljl-t'>
    </span><span class='hljl-n'>n</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>size</span><span class='hljl-p'>(</span><span class='hljl-n'>A</span><span class='hljl-p'>,</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>dv</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ev</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>L</span><span class='hljl-oB'>.</span><span class='hljl-n'>data</span><span class='hljl-oB'>.</span><span class='hljl-n'>dv</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>L</span><span class='hljl-oB'>.</span><span class='hljl-n'>data</span><span class='hljl-oB'>.</span><span class='hljl-n'>ev</span><span class='hljl-t'>
    </span><span class='hljl-nd'>@inbounds</span><span class='hljl-t'> </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>i</span><span class='hljl-p'>,</span><span class='hljl-n'>d</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-nf'>enumerate</span><span class='hljl-p'>(</span><span class='hljl-nf'>diagind</span><span class='hljl-p'>(</span><span class='hljl-n'>A</span><span class='hljl-p'>))</span><span class='hljl-t'>
        </span><span class='hljl-n'>dv</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>A</span><span class='hljl-p'>[</span><span class='hljl-n'>d</span><span class='hljl-p'>]</span><span class='hljl-t'>
    </span><span class='hljl-k'>end</span><span class='hljl-t'>
    </span><span class='hljl-nd'>@inbounds</span><span class='hljl-t'> </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>i</span><span class='hljl-p'>,</span><span class='hljl-n'>d</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-nf'>enumerate</span><span class='hljl-p'>(</span><span class='hljl-nf'>diagind</span><span class='hljl-p'>(</span><span class='hljl-n'>A</span><span class='hljl-p'>,</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-p'>))</span><span class='hljl-t'>
        </span><span class='hljl-n'>ev</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>A</span><span class='hljl-p'>[</span><span class='hljl-n'>d</span><span class='hljl-p'>]</span><span class='hljl-t'>
    </span><span class='hljl-k'>end</span><span class='hljl-t'>
    </span><span class='hljl-nd'>@inbounds</span><span class='hljl-t'> </span><span class='hljl-nd'>@simd</span><span class='hljl-t'> </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-n'>i</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>:</span><span class='hljl-t'> </span><span class='hljl-n'>n</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-t'>
        </span><span class='hljl-n'>ev</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'>   </span><span class='hljl-oB'>/=</span><span class='hljl-t'> </span><span class='hljl-n'>dv</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'>
        </span><span class='hljl-n'>dv</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-oB'>+</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>-=</span><span class='hljl-t'> </span><span class='hljl-nf'>abs2</span><span class='hljl-p'>(</span><span class='hljl-n'>ev</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>])</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>dv</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'>
    </span><span class='hljl-k'>end</span><span class='hljl-t'>
    </span><span class='hljl-n'>L</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre>


<pre class="output">
LDLt_inplace&#33; &#40;generic function with 1 method&#41;
</pre>


<h1>Investigating the model</h1>
<p>Let&#39;s take a look at what results of the model look like:</p>


<pre class='hljl'>
<span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>run</span><span class='hljl-p'>(</span><span class='hljl-oB'>::</span><span class='hljl-n'>SolverDiffEq</span><span class='hljl-p'>;</span><span class='hljl-t'> </span><span class='hljl-n'>N</span><span class='hljl-oB'>=</span><span class='hljl-ni'>20</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Cm</span><span class='hljl-oB'>=</span><span class='hljl-ni'>32</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ω</span><span class='hljl-oB'>=</span><span class='hljl-ni'>200</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>time_end</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>1.</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>solver</span><span class='hljl-oB'>=</span><span class='hljl-nf'>TRBDF2</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>reltol</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>1e-6</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>abstol</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>1e-6</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>f</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>FilamentCache</span><span class='hljl-p'>(</span><span class='hljl-n'>N</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Solver</span><span class='hljl-oB'>=</span><span class='hljl-n'>SolverDiffEq</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Cm</span><span class='hljl-oB'>=</span><span class='hljl-n'>Cm</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ω</span><span class='hljl-oB'>=</span><span class='hljl-n'>ω</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>r0</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>initialize!</span><span class='hljl-p'>(</span><span class='hljl-sc'>:StraightX</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-nf'>stiffness_matrix!</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>prob</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>ODEProblem</span><span class='hljl-p'>(</span><span class='hljl-nf'>ODEFunction</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>jac</span><span class='hljl-oB'>=</span><span class='hljl-p'>(</span><span class='hljl-n'>J</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>u</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>p</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>t</span><span class='hljl-p'>)</span><span class='hljl-oB'>-&gt;</span><span class='hljl-p'>(</span><span class='hljl-nf'>mul!</span><span class='hljl-p'>(</span><span class='hljl-n'>J</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-n'>P</span><span class='hljl-oB'>.</span><span class='hljl-n'>P</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-n'>A</span><span class='hljl-p'>);</span><span class='hljl-t'> </span><span class='hljl-n'>nothing</span><span class='hljl-p'>)),</span><span class='hljl-t'> </span><span class='hljl-n'>r0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-nfB'>0.</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>time_end</span><span class='hljl-p'>))</span><span class='hljl-t'>
    </span><span class='hljl-n'>sol</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>solve</span><span class='hljl-p'>(</span><span class='hljl-n'>prob</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>solver</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>dense</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>reltol</span><span class='hljl-oB'>=</span><span class='hljl-n'>reltol</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>abstol</span><span class='hljl-oB'>=</span><span class='hljl-n'>abstol</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre>


<pre class="output">
run &#40;generic function with 1 method&#41;
</pre>


<p>This method runs the model with the <code>TRBDF2</code> method and the default parameters.</p>


<pre class='hljl'>
<span class='hljl-n'>sol</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>run</span><span class='hljl-p'>(</span><span class='hljl-nf'>SolverDiffEq</span><span class='hljl-p'>())</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>sol</span><span class='hljl-p'>,</span><span class='hljl-n'>vars</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-ni'>25</span><span class='hljl-p'>))</span>
</pre>


<img src="data:image/png;base64,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"  />

<p>The model quickly falls into a highly oscillatory mode which then dominates throughout the rest of the solution.</p>
<h1>Work-Precision Diagrams</h1>
<p>Now let&#39;s build the problem and solve it once at high accuracy to get a reference solution:</p>


<pre class='hljl'>
<span class='hljl-n'>N</span><span class='hljl-oB'>=</span><span class='hljl-ni'>20</span><span class='hljl-t'>
</span><span class='hljl-n'>f</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>FilamentCache</span><span class='hljl-p'>(</span><span class='hljl-n'>N</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Solver</span><span class='hljl-oB'>=</span><span class='hljl-n'>SolverDiffEq</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>r0</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>initialize!</span><span class='hljl-p'>(</span><span class='hljl-sc'>:StraightX</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>stiffness_matrix!</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>prob</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>ODEProblem</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>r0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-nfB'>0.</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.01</span><span class='hljl-p'>))</span><span class='hljl-t'>

</span><span class='hljl-n'>sol</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>solve</span><span class='hljl-p'>(</span><span class='hljl-n'>prob</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nf'>Vern9</span><span class='hljl-p'>(),</span><span class='hljl-t'> </span><span class='hljl-n'>reltol</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>1e-14</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>abstol</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>1e-14</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>test_sol</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>TestSolution</span><span class='hljl-p'>(</span><span class='hljl-n'>sol</span><span class='hljl-p'>);</span>
</pre>



<h2>High Tolerance &#40;Low Accuracy&#41;</h2>
<h3>Endpoint Error</h3>
<p>ODEInterfaceDiffEq solvers failed to run.</p>


<pre class='hljl'>
<span class='hljl-n'>abstols</span><span class='hljl-oB'>=</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>./</span><span class='hljl-ni'>10</span><span class='hljl-t'> </span><span class='hljl-oB'>.^</span><span class='hljl-p'>(</span><span class='hljl-ni'>3</span><span class='hljl-oB'>:</span><span class='hljl-ni'>8</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>reltols</span><span class='hljl-oB'>=</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>./</span><span class='hljl-ni'>10</span><span class='hljl-t'> </span><span class='hljl-oB'>.^</span><span class='hljl-p'>(</span><span class='hljl-ni'>3</span><span class='hljl-oB'>:</span><span class='hljl-ni'>8</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>setups</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>CVODE_BDF</span><span class='hljl-p'>()),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>Rosenbrock23</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>Rodas4</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>BS3</span><span class='hljl-p'>()),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>Tsit5</span><span class='hljl-p'>()),</span><span class='hljl-t'>
    </span><span class='hljl-cs'>#Dict(:alg =&gt; ImplicitEuler(autodiff=false)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>Trapezoid</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>TRBDF2</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-cs'>#Dict(:alg =&gt; radau()),</span><span class='hljl-t'>
    </span><span class='hljl-cs'>#Dict(:alg =&gt; rodas()),</span><span class='hljl-t'>
    </span><span class='hljl-cs'>#Dict(:alg =&gt; dop853()),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>lsoda</span><span class='hljl-p'>()),</span><span class='hljl-t'>
</span><span class='hljl-p'>];</span><span class='hljl-t'>

</span><span class='hljl-n'>names</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;CVODE-BDF&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;Rosenbrock23&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;Rodas4&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;BS3&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;Tsit5&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-cs'>#&quot;ImplicitEuler&quot;,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;Trapezoid&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;TRBDF2&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-cs'>#&quot;radau&quot;,</span><span class='hljl-t'>
    </span><span class='hljl-cs'>#&quot;rodas&quot;,</span><span class='hljl-t'>
    </span><span class='hljl-cs'>#&quot;dop853&quot;,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;lsoda&quot;</span><span class='hljl-t'>
</span><span class='hljl-p'>];</span><span class='hljl-t'>


</span><span class='hljl-n'>wp</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>WorkPrecisionSet</span><span class='hljl-p'>(</span><span class='hljl-n'>prob</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>abstols</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>reltols</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>setups</span><span class='hljl-p'>;</span><span class='hljl-t'> </span><span class='hljl-n'>names</span><span class='hljl-oB'>=</span><span class='hljl-n'>names</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>appxsol</span><span class='hljl-oB'>=</span><span class='hljl-n'>test_sol</span><span class='hljl-p'>,</span><span class='hljl-t'>
                      </span><span class='hljl-n'>maxiters</span><span class='hljl-oB'>=</span><span class='hljl-nf'>Int</span><span class='hljl-p'>(</span><span class='hljl-nfB'>1e6</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>verbose</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-kc'>false</span><span class='hljl-p'>)</span>
</pre>


<pre class="julia-error">
ERROR: cannot resize array with shared data
</pre>



<pre class='hljl'>
<span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>wp</span><span class='hljl-p'>)</span>
</pre>


<pre class="julia-error">
ERROR: UndefVarError: wp not defined
</pre>



<pre class='hljl'>
<span class='hljl-n'>abstols</span><span class='hljl-oB'>=</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>./</span><span class='hljl-ni'>10</span><span class='hljl-t'> </span><span class='hljl-oB'>.^</span><span class='hljl-p'>(</span><span class='hljl-ni'>3</span><span class='hljl-oB'>:</span><span class='hljl-ni'>8</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>reltols</span><span class='hljl-oB'>=</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>./</span><span class='hljl-ni'>10</span><span class='hljl-t'> </span><span class='hljl-oB'>.^</span><span class='hljl-p'>(</span><span class='hljl-ni'>3</span><span class='hljl-oB'>:</span><span class='hljl-ni'>8</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>setups</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>CVODE_BDF</span><span class='hljl-p'>()),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>Rosenbrock23</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>Rodas4</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>ImplicitEuler</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>TRBDF2</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-cs'>#Dict(:alg =&gt; radau()),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>KenCarp3</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>KenCarp4</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>Kvaerno3</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>Kvaerno4</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>))</span><span class='hljl-t'>
</span><span class='hljl-p'>];</span><span class='hljl-t'>

</span><span class='hljl-n'>names</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;CVODE-BDF&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;Rosenbrock23&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;Rodas4&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;ImplicitEuler&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;TRBDF2&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-cs'>#&quot;radau&quot;,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;KenCarp3&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;KenCarp4&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;Kvaerno3&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;Kvaerno4&quot;</span><span class='hljl-t'>
</span><span class='hljl-p'>];</span><span class='hljl-t'>


</span><span class='hljl-n'>wp</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>WorkPrecisionSet</span><span class='hljl-p'>(</span><span class='hljl-n'>prob</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>abstols</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>reltols</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>setups</span><span class='hljl-p'>;</span><span class='hljl-t'> </span><span class='hljl-n'>names</span><span class='hljl-oB'>=</span><span class='hljl-n'>names</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>appxsol</span><span class='hljl-oB'>=</span><span class='hljl-n'>test_sol</span><span class='hljl-p'>,</span><span class='hljl-t'>
                      </span><span class='hljl-n'>maxiters</span><span class='hljl-oB'>=</span><span class='hljl-nf'>Int</span><span class='hljl-p'>(</span><span class='hljl-nfB'>1e6</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>verbose</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-kc'>false</span><span class='hljl-p'>)</span>
</pre>


<pre class="julia-error">
ERROR: cannot resize array with shared data
</pre>



<pre class='hljl'>
<span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>wp</span><span class='hljl-p'>)</span>
</pre>


<pre class="julia-error">
ERROR: UndefVarError: wp not defined
</pre>


<h3>Timeseries Error</h3>


<pre class='hljl'>
<span class='hljl-n'>abstols</span><span class='hljl-oB'>=</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>./</span><span class='hljl-ni'>10</span><span class='hljl-t'> </span><span class='hljl-oB'>.^</span><span class='hljl-p'>(</span><span class='hljl-ni'>3</span><span class='hljl-oB'>:</span><span class='hljl-ni'>8</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>reltols</span><span class='hljl-oB'>=</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>./</span><span class='hljl-ni'>10</span><span class='hljl-t'> </span><span class='hljl-oB'>.^</span><span class='hljl-p'>(</span><span class='hljl-ni'>3</span><span class='hljl-oB'>:</span><span class='hljl-ni'>8</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>setups</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>CVODE_BDF</span><span class='hljl-p'>()),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>Rosenbrock23</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>Rodas4</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>Trapezoid</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>TRBDF2</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-cs'>#Dict(:alg =&gt; radau()),</span><span class='hljl-t'>
    </span><span class='hljl-cs'>#Dict(:alg =&gt; rodas()),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>lsoda</span><span class='hljl-p'>())</span><span class='hljl-t'>
</span><span class='hljl-p'>];</span><span class='hljl-t'>

</span><span class='hljl-n'>names</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;CVODE-BDF&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;Rosenbrock23&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;Rodas4&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;Trapezoid&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;TRBDF2&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-cs'>#&quot;radau&quot;,</span><span class='hljl-t'>
    </span><span class='hljl-cs'>#&quot;rodas&quot;,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;lsoda&quot;</span><span class='hljl-t'>
</span><span class='hljl-p'>];</span><span class='hljl-t'>


</span><span class='hljl-n'>wp</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>WorkPrecisionSet</span><span class='hljl-p'>(</span><span class='hljl-n'>prob</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>abstols</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>reltols</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>setups</span><span class='hljl-p'>;</span><span class='hljl-t'> </span><span class='hljl-n'>names</span><span class='hljl-oB'>=</span><span class='hljl-n'>names</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>appxsol</span><span class='hljl-oB'>=</span><span class='hljl-n'>test_sol</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>dense</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-kc'>false</span><span class='hljl-p'>,</span><span class='hljl-t'>
                      </span><span class='hljl-n'>maxiters</span><span class='hljl-oB'>=</span><span class='hljl-nf'>Int</span><span class='hljl-p'>(</span><span class='hljl-nfB'>1e6</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>verbose</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-kc'>false</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>error_estimate</span><span class='hljl-oB'>=:</span><span class='hljl-n'>l2</span><span class='hljl-p'>)</span>
</pre>


<pre class="julia-error">
ERROR: cannot resize array with shared data
</pre>



<pre class='hljl'>
<span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>wp</span><span class='hljl-p'>)</span>
</pre>


<pre class="julia-error">
ERROR: UndefVarError: wp not defined
</pre>


<p>By looking at the previous plots, we can see that <code>TRBDF2</code> is the quicker one and <code>lsoda</code> is the slower one &#40;the colors are similar&#33;&#41;</p>


<pre class='hljl'>
<span class='hljl-n'>abstols</span><span class='hljl-oB'>=</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>./</span><span class='hljl-ni'>10</span><span class='hljl-t'> </span><span class='hljl-oB'>.^</span><span class='hljl-p'>(</span><span class='hljl-ni'>3</span><span class='hljl-oB'>:</span><span class='hljl-ni'>8</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>reltols</span><span class='hljl-oB'>=</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>./</span><span class='hljl-ni'>10</span><span class='hljl-t'> </span><span class='hljl-oB'>.^</span><span class='hljl-p'>(</span><span class='hljl-ni'>3</span><span class='hljl-oB'>:</span><span class='hljl-ni'>8</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>setups</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>CVODE_BDF</span><span class='hljl-p'>()),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>Rosenbrock23</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>Rodas4</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>TRBDF2</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-cs'>#Dict(:alg =&gt; radau()),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>KenCarp3</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>KenCarp4</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>Kvaerno3</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>Kvaerno4</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>))</span><span class='hljl-t'>
</span><span class='hljl-p'>];</span><span class='hljl-t'>

</span><span class='hljl-n'>names</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;CVODE-BDF&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;Rosenbrock23&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;Rodas4&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;TRBDF2&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-cs'>#&quot;radau&quot;,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;KenCarp3&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;KenCarp4&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;Kvaerno3&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;Kvaerno4&quot;</span><span class='hljl-t'>
</span><span class='hljl-p'>];</span><span class='hljl-t'>


</span><span class='hljl-n'>wp</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>WorkPrecisionSet</span><span class='hljl-p'>(</span><span class='hljl-n'>prob</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>abstols</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>reltols</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>setups</span><span class='hljl-p'>;</span><span class='hljl-t'> </span><span class='hljl-n'>names</span><span class='hljl-oB'>=</span><span class='hljl-n'>names</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>appxsol</span><span class='hljl-oB'>=</span><span class='hljl-n'>test_sol</span><span class='hljl-p'>,</span><span class='hljl-t'>
                      </span><span class='hljl-n'>maxiters</span><span class='hljl-oB'>=</span><span class='hljl-nf'>Int</span><span class='hljl-p'>(</span><span class='hljl-nfB'>1e6</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>verbose</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-kc'>false</span><span class='hljl-p'>)</span>
</pre>


<pre class="julia-error">
ERROR: cannot resize array with shared data
</pre>



<pre class='hljl'>
<span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>wp</span><span class='hljl-p'>)</span>
</pre>


<pre class="julia-error">
ERROR: UndefVarError: wp not defined
</pre>


<h3>Dense Error</h3>


<pre class='hljl'>
<span class='hljl-n'>abstols</span><span class='hljl-oB'>=</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>./</span><span class='hljl-ni'>10</span><span class='hljl-t'> </span><span class='hljl-oB'>.^</span><span class='hljl-p'>(</span><span class='hljl-ni'>3</span><span class='hljl-oB'>:</span><span class='hljl-ni'>8</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>reltols</span><span class='hljl-oB'>=</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>./</span><span class='hljl-ni'>10</span><span class='hljl-t'> </span><span class='hljl-oB'>.^</span><span class='hljl-p'>(</span><span class='hljl-ni'>3</span><span class='hljl-oB'>:</span><span class='hljl-ni'>8</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>setups</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>CVODE_BDF</span><span class='hljl-p'>()),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>Rosenbrock23</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>Rodas4</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>Trapezoid</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>TRBDF2</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
</span><span class='hljl-p'>];</span><span class='hljl-t'>

</span><span class='hljl-n'>names</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;CVODE-BDF&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;Rosenbrock23&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;Rodas4&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;Trapezoid&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;TRBDF2&quot;</span><span class='hljl-t'>
</span><span class='hljl-p'>];</span><span class='hljl-t'>


</span><span class='hljl-n'>wp</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>WorkPrecisionSet</span><span class='hljl-p'>(</span><span class='hljl-n'>prob</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>abstols</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>reltols</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>setups</span><span class='hljl-p'>;</span><span class='hljl-t'> </span><span class='hljl-n'>names</span><span class='hljl-oB'>=</span><span class='hljl-n'>names</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>appxsol</span><span class='hljl-oB'>=</span><span class='hljl-n'>test_sol</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>dense</span><span class='hljl-oB'>=</span><span class='hljl-kc'>true</span><span class='hljl-p'>,</span><span class='hljl-t'>
                      </span><span class='hljl-n'>maxiters</span><span class='hljl-oB'>=</span><span class='hljl-nf'>Int</span><span class='hljl-p'>(</span><span class='hljl-nfB'>1e6</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>verbose</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-kc'>false</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>dense_errors</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-kc'>true</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>error_estimate</span><span class='hljl-oB'>=:</span><span class='hljl-n'>L2</span><span class='hljl-p'>)</span>
</pre>


<pre class="julia-error">
ERROR: cannot resize array with shared data
</pre>



<pre class='hljl'>
<span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>wp</span><span class='hljl-p'>)</span>
</pre>


<pre class="julia-error">
ERROR: UndefVarError: wp not defined
</pre>



<pre class='hljl'>
<span class='hljl-n'>abstols</span><span class='hljl-oB'>=</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>./</span><span class='hljl-ni'>10</span><span class='hljl-t'> </span><span class='hljl-oB'>.^</span><span class='hljl-p'>(</span><span class='hljl-ni'>3</span><span class='hljl-oB'>:</span><span class='hljl-ni'>8</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>reltols</span><span class='hljl-oB'>=</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>./</span><span class='hljl-ni'>10</span><span class='hljl-t'> </span><span class='hljl-oB'>.^</span><span class='hljl-p'>(</span><span class='hljl-ni'>3</span><span class='hljl-oB'>:</span><span class='hljl-ni'>8</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>setups</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>CVODE_BDF</span><span class='hljl-p'>()),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>Rosenbrock23</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>Rodas4</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>TRBDF2</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>KenCarp3</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>KenCarp4</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>Kvaerno3</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>Kvaerno4</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>))</span><span class='hljl-t'>
</span><span class='hljl-p'>];</span><span class='hljl-t'>

</span><span class='hljl-n'>names</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;CVODE-BDF&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;Rosenbrock23&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;Rodas4&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;TRBDF2&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;KenCarp3&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;KenCarp4&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;Kvaerno3&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;Kvaerno4&quot;</span><span class='hljl-t'>
</span><span class='hljl-p'>];</span><span class='hljl-t'>


</span><span class='hljl-n'>wp</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>WorkPrecisionSet</span><span class='hljl-p'>(</span><span class='hljl-n'>prob</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>abstols</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>reltols</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>setups</span><span class='hljl-p'>;</span><span class='hljl-t'> </span><span class='hljl-n'>names</span><span class='hljl-oB'>=</span><span class='hljl-n'>names</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>appxsol</span><span class='hljl-oB'>=</span><span class='hljl-n'>test_sol</span><span class='hljl-p'>,</span><span class='hljl-t'>
                      </span><span class='hljl-n'>maxiters</span><span class='hljl-oB'>=</span><span class='hljl-nf'>Int</span><span class='hljl-p'>(</span><span class='hljl-nfB'>1e6</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>verbose</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-kc'>false</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>dense_errors</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-kc'>true</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>error_estimate</span><span class='hljl-oB'>=:</span><span class='hljl-n'>L2</span><span class='hljl-p'>)</span>
</pre>


<pre class="julia-error">
ERROR: cannot resize array with shared data
</pre>



<pre class='hljl'>
<span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>wp</span><span class='hljl-p'>)</span>
</pre>


<pre class="julia-error">
ERROR: UndefVarError: wp not defined
</pre>


<h2>Low Tolerance &#40;High Accuracy&#41;</h2>


<pre class='hljl'>
<span class='hljl-n'>abstols</span><span class='hljl-oB'>=</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>./</span><span class='hljl-ni'>10</span><span class='hljl-t'> </span><span class='hljl-oB'>.^</span><span class='hljl-p'>(</span><span class='hljl-ni'>6</span><span class='hljl-oB'>:</span><span class='hljl-ni'>12</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>reltols</span><span class='hljl-oB'>=</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>./</span><span class='hljl-ni'>10</span><span class='hljl-t'> </span><span class='hljl-oB'>.^</span><span class='hljl-p'>(</span><span class='hljl-ni'>6</span><span class='hljl-oB'>:</span><span class='hljl-ni'>12</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>setups</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>CVODE_BDF</span><span class='hljl-p'>()),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>Vern7</span><span class='hljl-p'>()),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>Vern9</span><span class='hljl-p'>()),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>TRBDF2</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-cs'>#Dict(:alg =&gt; radau()),</span><span class='hljl-t'>
    </span><span class='hljl-cs'>#Dict(:alg =&gt; dop853())</span><span class='hljl-t'>
</span><span class='hljl-p'>];</span><span class='hljl-t'>

</span><span class='hljl-n'>names</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;CVODE_BDF&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;Vern7&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;Vern9&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;TRBDF2&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-cs'>#&quot;radau&quot;,</span><span class='hljl-t'>
    </span><span class='hljl-cs'>#&quot;dop853&quot;</span><span class='hljl-t'>
</span><span class='hljl-p'>];</span><span class='hljl-t'>

</span><span class='hljl-n'>wp</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>WorkPrecisionSet</span><span class='hljl-p'>(</span><span class='hljl-n'>prob</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>abstols</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>reltols</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>setups</span><span class='hljl-p'>;</span><span class='hljl-t'> </span><span class='hljl-n'>names</span><span class='hljl-oB'>=</span><span class='hljl-n'>names</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>appxsol</span><span class='hljl-oB'>=</span><span class='hljl-n'>test_sol</span><span class='hljl-p'>,</span><span class='hljl-t'>
                      </span><span class='hljl-n'>maxiters</span><span class='hljl-oB'>=</span><span class='hljl-nf'>Int</span><span class='hljl-p'>(</span><span class='hljl-nfB'>1e6</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>verbose</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-kc'>false</span><span class='hljl-p'>)</span>
</pre>


<pre class="julia-error">
ERROR: cannot resize array with shared data
</pre>



<pre class='hljl'>
<span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>wp</span><span class='hljl-p'>)</span>
</pre>


<pre class="julia-error">
ERROR: UndefVarError: wp not defined
</pre>



<pre class='hljl'>
<span class='hljl-n'>abstols</span><span class='hljl-oB'>=</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>./</span><span class='hljl-ni'>10</span><span class='hljl-t'> </span><span class='hljl-oB'>.^</span><span class='hljl-p'>(</span><span class='hljl-ni'>6</span><span class='hljl-oB'>:</span><span class='hljl-ni'>12</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>reltols</span><span class='hljl-oB'>=</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>./</span><span class='hljl-ni'>10</span><span class='hljl-t'> </span><span class='hljl-oB'>.^</span><span class='hljl-p'>(</span><span class='hljl-ni'>6</span><span class='hljl-oB'>:</span><span class='hljl-ni'>12</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>setups</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>CVODE_BDF</span><span class='hljl-p'>()),</span><span class='hljl-t'>
    </span><span class='hljl-cs'>#Dict(:alg =&gt; radau()),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>TRBDF2</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>Kvaerno3</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>KenCarp3</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>Kvaerno4</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>KenCarp4</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>Kvaerno5</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>KenCarp5</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>lsoda</span><span class='hljl-p'>())</span><span class='hljl-t'>
</span><span class='hljl-p'>];</span><span class='hljl-t'>

</span><span class='hljl-n'>names</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;CVODE_BDF&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-cs'>#&quot;radau&quot;,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;TRBDF2&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;Kvaerno3&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;KenCarp3&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;Kvaerno4&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;KenCarp4&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;Kvaerno5&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;KenCarp5&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;lsoda&quot;</span><span class='hljl-t'>
</span><span class='hljl-p'>];</span><span class='hljl-t'>

</span><span class='hljl-n'>wp</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>WorkPrecisionSet</span><span class='hljl-p'>(</span><span class='hljl-n'>prob</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>abstols</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>reltols</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>setups</span><span class='hljl-p'>;</span><span class='hljl-t'> </span><span class='hljl-n'>names</span><span class='hljl-oB'>=</span><span class='hljl-n'>names</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>appxsol</span><span class='hljl-oB'>=</span><span class='hljl-n'>test_sol</span><span class='hljl-p'>,</span><span class='hljl-t'>
                                    </span><span class='hljl-n'>maxiters</span><span class='hljl-oB'>=</span><span class='hljl-nf'>Int</span><span class='hljl-p'>(</span><span class='hljl-nfB'>1e6</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>verbose</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-kc'>false</span><span class='hljl-p'>)</span>
</pre>


<pre class="julia-error">
ERROR: cannot resize array with shared data
</pre>



<pre class='hljl'>
<span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>wp</span><span class='hljl-p'>)</span>
</pre>


<pre class="julia-error">
ERROR: UndefVarError: wp not defined
</pre>


<p>By looking at the previous plots, we can see that <code>KenCarp3</code> is the quicker one and <code>lsoda</code> is the slower one &#40;the colors are similar&#33;&#41;</p>
<h3>Timeseries Error</h3>


<pre class='hljl'>
<span class='hljl-n'>abstols</span><span class='hljl-oB'>=</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>./</span><span class='hljl-ni'>10</span><span class='hljl-t'> </span><span class='hljl-oB'>.^</span><span class='hljl-p'>(</span><span class='hljl-ni'>6</span><span class='hljl-oB'>:</span><span class='hljl-ni'>12</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>reltols</span><span class='hljl-oB'>=</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>./</span><span class='hljl-ni'>10</span><span class='hljl-t'> </span><span class='hljl-oB'>.^</span><span class='hljl-p'>(</span><span class='hljl-ni'>6</span><span class='hljl-oB'>:</span><span class='hljl-ni'>12</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>setups</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>CVODE_BDF</span><span class='hljl-p'>()),</span><span class='hljl-t'>
    </span><span class='hljl-cs'>#Dict(:alg =&gt; radau()),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>TRBDF2</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>Kvaerno3</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>KenCarp3</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>Kvaerno4</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>KenCarp4</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>Kvaerno5</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>KenCarp5</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>lsoda</span><span class='hljl-p'>())</span><span class='hljl-t'>
</span><span class='hljl-p'>];</span><span class='hljl-t'>

</span><span class='hljl-n'>names</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;CVODE_BDF&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-cs'>#&quot;radau&quot;,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;TRBDF2&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;Kvaerno3&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;KenCarp3&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;Kvaerno4&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;KenCarp4&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;Kvaerno5&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;KenCarp5&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;lsoda&quot;</span><span class='hljl-t'>
</span><span class='hljl-p'>];</span><span class='hljl-t'>

</span><span class='hljl-n'>wp</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>WorkPrecisionSet</span><span class='hljl-p'>(</span><span class='hljl-n'>prob</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>abstols</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>reltols</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>setups</span><span class='hljl-p'>;</span><span class='hljl-t'> </span><span class='hljl-n'>names</span><span class='hljl-oB'>=</span><span class='hljl-n'>names</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>appxsol</span><span class='hljl-oB'>=</span><span class='hljl-n'>test_sol</span><span class='hljl-p'>,</span><span class='hljl-t'>
                      </span><span class='hljl-n'>maxiters</span><span class='hljl-oB'>=</span><span class='hljl-nf'>Int</span><span class='hljl-p'>(</span><span class='hljl-nfB'>1e6</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>verbose</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-kc'>false</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>error_estimate</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-sc'>:l2</span><span class='hljl-p'>)</span>
</pre>


<pre class="julia-error">
ERROR: cannot resize array with shared data
</pre>



<pre class='hljl'>
<span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>wp</span><span class='hljl-p'>)</span>
</pre>


<pre class="julia-error">
ERROR: UndefVarError: wp not defined
</pre>


<h3>Dense Error</h3>


<pre class='hljl'>
<span class='hljl-n'>abstols</span><span class='hljl-oB'>=</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>./</span><span class='hljl-ni'>10</span><span class='hljl-t'> </span><span class='hljl-oB'>.^</span><span class='hljl-p'>(</span><span class='hljl-ni'>6</span><span class='hljl-oB'>:</span><span class='hljl-ni'>12</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>reltols</span><span class='hljl-oB'>=</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>./</span><span class='hljl-ni'>10</span><span class='hljl-t'> </span><span class='hljl-oB'>.^</span><span class='hljl-p'>(</span><span class='hljl-ni'>6</span><span class='hljl-oB'>:</span><span class='hljl-ni'>12</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>setups</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>CVODE_BDF</span><span class='hljl-p'>()),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>TRBDF2</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>Kvaerno3</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>KenCarp3</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>Kvaerno4</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>KenCarp4</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>Kvaerno5</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>KenCarp5</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
</span><span class='hljl-p'>];</span><span class='hljl-t'>

</span><span class='hljl-n'>names</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;CVODE_BDF&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;TRBDF2&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;Kvaerno3&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;KenCarp3&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;Kvaerno4&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;KenCarp4&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;Kvaerno5&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;KenCarp5&quot;</span><span class='hljl-t'>
</span><span class='hljl-p'>];</span><span class='hljl-t'>

</span><span class='hljl-n'>wp</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>WorkPrecisionSet</span><span class='hljl-p'>(</span><span class='hljl-n'>prob</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>abstols</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>reltols</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>setups</span><span class='hljl-p'>;</span><span class='hljl-t'> </span><span class='hljl-n'>names</span><span class='hljl-oB'>=</span><span class='hljl-n'>names</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>appxsol</span><span class='hljl-oB'>=</span><span class='hljl-n'>test_sol</span><span class='hljl-p'>,</span><span class='hljl-t'>
                      </span><span class='hljl-n'>maxiters</span><span class='hljl-oB'>=</span><span class='hljl-nf'>Int</span><span class='hljl-p'>(</span><span class='hljl-nfB'>1e6</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>verbose</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-kc'>false</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>dense_errors</span><span class='hljl-oB'>=</span><span class='hljl-kc'>true</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>error_estimate</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-sc'>:L2</span><span class='hljl-p'>)</span>
</pre>


<pre class="julia-error">
ERROR: cannot resize array with shared data
</pre>



<pre class='hljl'>
<span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>wp</span><span class='hljl-p'>)</span>
</pre>


<pre class="julia-error">
ERROR: UndefVarError: wp not defined
</pre>


<h1>No Jacobian Work-Precision Diagrams</h1>
<p>In the previous cases the analytical Jacobian is given and is used by the solvers. Now we will solve the same problem without the analytical Jacobian.</p>
<p>Note that the pre-caching means that the model is not compatible with autodifferentiation by ForwardDiff. Thus all of the native Julia solvers are set to <code>autodiff&#61;false</code> to use DiffEqDiffTools.jl&#39;s numerical differentiation backend. We&#39;ll only benchmark the methods that did well before.</p>


<pre class='hljl'>
<span class='hljl-n'>N</span><span class='hljl-oB'>=</span><span class='hljl-ni'>20</span><span class='hljl-t'>
</span><span class='hljl-n'>f</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>FilamentCache</span><span class='hljl-p'>(</span><span class='hljl-n'>N</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Solver</span><span class='hljl-oB'>=</span><span class='hljl-n'>SolverDiffEq</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>r0</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>initialize!</span><span class='hljl-p'>(</span><span class='hljl-sc'>:StraightX</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>stiffness_matrix!</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>prob</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>ODEProblem</span><span class='hljl-p'>((</span><span class='hljl-n'>t</span><span class='hljl-p'>,</span><span class='hljl-n'>r</span><span class='hljl-p'>,</span><span class='hljl-n'>dr</span><span class='hljl-p'>)</span><span class='hljl-oB'>-&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>t</span><span class='hljl-p'>,</span><span class='hljl-n'>r</span><span class='hljl-p'>,</span><span class='hljl-n'>dr</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>r0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-nfB'>0.</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.01</span><span class='hljl-p'>))</span><span class='hljl-t'>

</span><span class='hljl-n'>sol</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>solve</span><span class='hljl-p'>(</span><span class='hljl-n'>prob</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nf'>Vern9</span><span class='hljl-p'>(),</span><span class='hljl-t'> </span><span class='hljl-n'>reltol</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>1e-14</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>abstol</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>1e-14</span><span class='hljl-p'>)</span>
</pre>


<pre class="julia-error">
ERROR: MethodError: no method matching &#40;::Main.WeaveSandBox4.FilamentCache&#123;Main.WeaveSandBox4.FerromagneticContinuous,Main.WeaveSandBox4.NoHydroProjectionCache,Main.WeaveSandBox4.DiffEqSolverCache&#125;&#41;&#40;::Array&#123;Float64,1&#125;, ::Nothing, ::Float64&#41;
Closest candidates are:
  FilamentCache&#40;::Any, ::Any, ::Any, &#33;Matched::Any&#41; at none:3
</pre>



<pre class='hljl'>
<span class='hljl-n'>test_sol</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>TestSolution</span><span class='hljl-p'>(</span><span class='hljl-n'>sol</span><span class='hljl-oB'>.</span><span class='hljl-n'>t</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>sol</span><span class='hljl-oB'>.</span><span class='hljl-n'>u</span><span class='hljl-p'>);</span>
</pre>



<h2>High Tolerance &#40;Low Accuracy&#41;</h2>


<pre class='hljl'>
<span class='hljl-n'>abstols</span><span class='hljl-oB'>=</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>./</span><span class='hljl-ni'>10</span><span class='hljl-t'> </span><span class='hljl-oB'>.^</span><span class='hljl-p'>(</span><span class='hljl-ni'>3</span><span class='hljl-oB'>:</span><span class='hljl-ni'>8</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>reltols</span><span class='hljl-oB'>=</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>./</span><span class='hljl-ni'>10</span><span class='hljl-t'> </span><span class='hljl-oB'>.^</span><span class='hljl-p'>(</span><span class='hljl-ni'>3</span><span class='hljl-oB'>:</span><span class='hljl-ni'>8</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>setups</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>CVODE_BDF</span><span class='hljl-p'>()),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>TRBDF2</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-cs'>#Dict(:alg =&gt; rodas()),</span><span class='hljl-t'>
    </span><span class='hljl-cs'>#Dict(:alg =&gt; radau()),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>KenCarp3</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>Kvaerno4</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>))</span><span class='hljl-t'>
</span><span class='hljl-p'>];</span><span class='hljl-t'>

</span><span class='hljl-n'>names</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;CVODE BDF&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;TRBDF2&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-cs'>#&quot;rodas&quot;,</span><span class='hljl-t'>
    </span><span class='hljl-cs'>#&quot;radau&quot;,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;KenCarp3&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;Kvaerno4&quot;</span><span class='hljl-t'>
</span><span class='hljl-p'>];</span><span class='hljl-t'>


</span><span class='hljl-n'>wp</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>WorkPrecisionSet</span><span class='hljl-p'>(</span><span class='hljl-n'>prob</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>abstols</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>reltols</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>setups</span><span class='hljl-p'>;</span><span class='hljl-t'> </span><span class='hljl-n'>names</span><span class='hljl-oB'>=</span><span class='hljl-n'>names</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>appxsol</span><span class='hljl-oB'>=</span><span class='hljl-n'>test_sol</span><span class='hljl-p'>,</span><span class='hljl-t'>
                      </span><span class='hljl-n'>maxiters</span><span class='hljl-oB'>=</span><span class='hljl-nf'>Int</span><span class='hljl-p'>(</span><span class='hljl-nfB'>1e6</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>verbose</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-kc'>true</span><span class='hljl-p'>,</span><span class='hljl-n'>numruns</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>10</span><span class='hljl-p'>)</span>
</pre>


<pre class="julia-error">
ERROR: MethodError: no method matching &#40;::Main.WeaveSandBox4.FilamentCache&#123;Main.WeaveSandBox4.FerromagneticContinuous,Main.WeaveSandBox4.NoHydroProjectionCache,Main.WeaveSandBox4.DiffEqSolverCache&#125;&#41;&#40;::Array&#123;Float64,1&#125;, ::Nothing, ::Float64&#41;
Closest candidates are:
  FilamentCache&#40;::Any, ::Any, ::Any, &#33;Matched::Any&#41; at none:3
</pre>



<pre class='hljl'>
<span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>wp</span><span class='hljl-p'>)</span>
</pre>


<pre class="julia-error">
ERROR: UndefVarError: wp not defined
</pre>


<p>It looks like <code>radau</code> fails on this problem with low accuracy if the Jacobian is not passed, so its values should be ignored since it exits early.</p>
<h2>Low Tolerance &#40;High Accuracy&#41;</h2>


<pre class='hljl'>
<span class='hljl-n'>abstols</span><span class='hljl-oB'>=</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>./</span><span class='hljl-t'> </span><span class='hljl-ni'>10</span><span class='hljl-t'> </span><span class='hljl-oB'>.^</span><span class='hljl-p'>(</span><span class='hljl-ni'>6</span><span class='hljl-oB'>:</span><span class='hljl-ni'>12</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>reltols</span><span class='hljl-oB'>=</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>./</span><span class='hljl-t'> </span><span class='hljl-ni'>10</span><span class='hljl-t'> </span><span class='hljl-oB'>.^</span><span class='hljl-p'>(</span><span class='hljl-ni'>6</span><span class='hljl-oB'>:</span><span class='hljl-ni'>12</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>setups</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>CVODE_BDF</span><span class='hljl-p'>()),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>TRBDF2</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-cs'>#Dict(:alg =&gt; rodas()),</span><span class='hljl-t'>
    </span><span class='hljl-cs'>#Dict(:alg =&gt; radau()),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>KenCarp3</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)),</span><span class='hljl-t'>
    </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:alg</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>Kvaerno4</span><span class='hljl-p'>(</span><span class='hljl-n'>autodiff</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>))</span><span class='hljl-t'>
</span><span class='hljl-p'>];</span><span class='hljl-t'>

</span><span class='hljl-n'>names</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;CVODE BDF&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;TRBDF2&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-cs'>#&quot;rodas&quot;,</span><span class='hljl-t'>
    </span><span class='hljl-cs'>#&quot;radau&quot;,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;KenCarp3&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-s'>&quot;Kvaerno4&quot;</span><span class='hljl-t'>
</span><span class='hljl-p'>];</span><span class='hljl-t'>


</span><span class='hljl-n'>wp</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>WorkPrecisionSet</span><span class='hljl-p'>(</span><span class='hljl-n'>prob</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>abstols</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>reltols</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>setups</span><span class='hljl-p'>;</span><span class='hljl-t'> </span><span class='hljl-n'>names</span><span class='hljl-oB'>=</span><span class='hljl-n'>names</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>appxsol</span><span class='hljl-oB'>=</span><span class='hljl-n'>test_sol</span><span class='hljl-p'>,</span><span class='hljl-t'>
                      </span><span class='hljl-n'>maxiters</span><span class='hljl-oB'>=</span><span class='hljl-nf'>Int</span><span class='hljl-p'>(</span><span class='hljl-nfB'>1e6</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>verbose</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-kc'>true</span><span class='hljl-p'>,</span><span class='hljl-n'>numruns</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>10</span><span class='hljl-p'>)</span>
</pre>


<pre class="julia-error">
ERROR: MethodError: no method matching &#40;::Main.WeaveSandBox4.FilamentCache&#123;Main.WeaveSandBox4.FerromagneticContinuous,Main.WeaveSandBox4.NoHydroProjectionCache,Main.WeaveSandBox4.DiffEqSolverCache&#125;&#41;&#40;::Array&#123;Float64,1&#125;, ::Nothing, ::Float64&#41;
Closest candidates are:
  FilamentCache&#40;::Any, ::Any, ::Any, &#33;Matched::Any&#41; at none:3
</pre>



<pre class='hljl'>
<span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>wp</span><span class='hljl-p'>)</span>
</pre>


<pre class="julia-error">
ERROR: UndefVarError: wp not defined
</pre>


<h2>Conclusion</h2>
<p>Sundials&#39; <code>CVODE_BDF</code> does the best in this test. When the Jacobian is given, the ESDIRK methods <code>TRBDF2</code> and <code>KenCarp3</code> are able to do almost as well as it until <code>&lt;1e-6</code> error is needed. When Jacobians are not given, Sundials is the fastest without competition.</p>


<pre class='hljl'>
<span class='hljl-k'>using</span><span class='hljl-t'> </span><span class='hljl-n'>DiffEqBenchmarks</span><span class='hljl-t'>
</span><span class='hljl-n'>DiffEqBenchmarks</span><span class='hljl-oB'>.</span><span class='hljl-nf'>bench_footer</span><span class='hljl-p'>(</span><span class='hljl-n'>WEAVE_ARGS</span><span class='hljl-p'>[</span><span class='hljl-sc'>:folder</span><span class='hljl-p'>],</span><span class='hljl-n'>WEAVE_ARGS</span><span class='hljl-p'>[</span><span class='hljl-sc'>:file</span><span class='hljl-p'>])</span>
</pre>



<div class="markdown"><h2>Appendix</h2>
<p>These benchmarks are a part of the DiffEqBenchmarks.jl repository, found at: <a href="https://github.com/JuliaDiffEq/DiffEqBenchmarks.jl">https://github.com/JuliaDiffEq/DiffEqBenchmarks.jl</a></p>
</div>
<div class="markdown"><p>To locally run this tutorial, do the following commands:</p>
<pre><code>using DiffEqBenchmarks
DiffEqBenchmarks.weave_file&#40;&quot;StiffODE&quot;,&quot;Filament.jmd&quot;&#41;</code></pre>
</div>
<div class="markdown"><p>Computer Information:</p>
</div>
<div class="markdown"><pre><code>Julia Version 1.1.0
Commit 80516ca202 &#40;2019-01-21 21:24 UTC&#41;
Platform Info:
  OS: Linux &#40;x86_64-pc-linux-gnu&#41;
  CPU: Intel&#40;R&#41; Xeon&#40;R&#41; CPU E5-2680 v4 @ 2.40GHz
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-6.0.1 &#40;ORCJIT, haswell&#41;
</code></pre>
</div>
<div class="markdown"><p>Package Information:</p>
</div>
<div class="markdown"><pre><code>Status: &#96;/home/yingboma/.julia/dev/DiffEqBenchmarks/Project.toml&#96;
&#91;f3b72e0c-5b89-59e1-b016-84e28bfd966d&#93; DiffEqDevTools 2.7.2
&#91;a077e3f3-b75c-5d7f-a0c6-6bc4c8ec64a9&#93; DiffEqProblemLibrary 4.1.0
&#91;7073ff75-c697-5162-941a-fcdaad2a7d2a&#93; IJulia 1.17.0
&#91;7f56f5a3-f504-529b-bc02-0b1fe5e64312&#93; LSODA 0.4.0
&#91;c030b06c-0b6d-57c2-b091-7029874bd033&#93; ODE 2.4.0
&#91;54ca160b-1b9f-5127-a996-1867f4bc2a2c&#93; ODEInterface 0.4.5
&#91;09606e27-ecf5-54fc-bb29-004bd9f985bf&#93; ODEInterfaceDiffEq 3.1.0
&#91;1dea7af3-3e70-54e6-95c3-0bf5283fa5ed&#93; OrdinaryDiffEq 5.3.0
&#91;65888b18-ceab-5e60-b2b9-181511a3b968&#93; ParameterizedFunctions 4.1.1
&#91;91a5bcdd-55d7-5caf-9e0b-520d859cae80&#93; Plots 0.23.1
&#91;c3572dad-4567-51f8-b174-8c6c989267f4&#93; Sundials 3.2.0
&#91;44d3d7a6-8a23-5bf8-98c5-b353f8df5ec9&#93; Weave 0.8.1
&#91;b77e0a4c-d291-57a0-90e8-8db25a27a240&#93; InteractiveUtils 
&#91;d6f4376e-aef5-505a-96c1-9c027394607a&#93; Markdown 
&#91;44cfe95a-1eb2-52ea-b672-e2afdf69b78f&#93; Pkg 
&#91;9a3f8284-a2c9-5f02-9a11-845980a1fd5c&#93; Random </code></pre>
</div>



          <HR/>
          <div class="footer"><p>
          Published from <a href="Filament.jmd">Filament.jmd</a> using
          <a href="http://github.com/mpastell/Weave.jl">Weave.jl</a>
           on 2019-03-10.
          <p></div>


        </div>
      </div>
    </div>
  </BODY>
</HTML>
